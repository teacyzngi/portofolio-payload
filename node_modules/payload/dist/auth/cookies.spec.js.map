{"version":3,"sources":["../../src/auth/cookies.spec.ts"],"sourcesContent":["import { parseCookies } from './cookies.js'\n\ndescribe('parseCookies', () => {\n  it('parses cookie attributes without values', () => {\n    const fakeHeaders = new Map()\n    fakeHeaders.set('Cookie', 'my_value=true; Secure; HttpOnly')\n\n    const parsed = parseCookies(fakeHeaders as unknown as Request['headers'])\n\n    expect(parsed.get('my_value')).toBe('true')\n    expect(parsed.get('Secure')).toBe('true')\n    expect(parsed.get('HttpOnly')).toBe('true')\n    expect(parsed.size).toBe(3)\n  })\n  it('strips whitespace', () => {\n    const fakeHeaders = new Map()\n    fakeHeaders.set('Cookie', 'my_value=true; ')\n\n    const parsed = parseCookies(fakeHeaders as unknown as Request['headers'])\n\n    expect(parsed.get('my_value')).toBe('true')\n    expect(parsed.size).toBe(1)\n  })\n\n  it('ensure invalid cookies are ignored', () => {\n    const fakeHeaders = new Map()\n    fakeHeaders.set('Cookie', 'my_value=true; invalid_cookie=%E0%A4%A')\n\n    const parsed = parseCookies(fakeHeaders as unknown as Request['headers'])\n\n    expect(parsed.get('my_value')).toBe('true')\n    expect(parsed.size).toBe(1)\n  })\n\n  it('ensure empty map is returned if there are no cookies', () => {\n    const fakeHeaders = new Map()\n\n    const parsed = parseCookies(fakeHeaders as unknown as Request['headers'])\n\n    expect(parsed.size).toBe(0)\n  })\n})\n"],"names":["parseCookies","describe","it","fakeHeaders","Map","set","parsed","expect","get","toBe","size"],"mappings":"AAAA,SAASA,YAAY,QAAQ,eAAc;AAE3CC,SAAS,gBAAgB;IACvBC,GAAG,2CAA2C;QAC5C,MAAMC,cAAc,IAAIC;QACxBD,YAAYE,GAAG,CAAC,UAAU;QAE1B,MAAMC,SAASN,aAAaG;QAE5BI,OAAOD,OAAOE,GAAG,CAAC,aAAaC,IAAI,CAAC;QACpCF,OAAOD,OAAOE,GAAG,CAAC,WAAWC,IAAI,CAAC;QAClCF,OAAOD,OAAOE,GAAG,CAAC,aAAaC,IAAI,CAAC;QACpCF,OAAOD,OAAOI,IAAI,EAAED,IAAI,CAAC;IAC3B;IACAP,GAAG,qBAAqB;QACtB,MAAMC,cAAc,IAAIC;QACxBD,YAAYE,GAAG,CAAC,UAAU;QAE1B,MAAMC,SAASN,aAAaG;QAE5BI,OAAOD,OAAOE,GAAG,CAAC,aAAaC,IAAI,CAAC;QACpCF,OAAOD,OAAOI,IAAI,EAAED,IAAI,CAAC;IAC3B;IAEAP,GAAG,sCAAsC;QACvC,MAAMC,cAAc,IAAIC;QACxBD,YAAYE,GAAG,CAAC,UAAU;QAE1B,MAAMC,SAASN,aAAaG;QAE5BI,OAAOD,OAAOE,GAAG,CAAC,aAAaC,IAAI,CAAC;QACpCF,OAAOD,OAAOI,IAAI,EAAED,IAAI,CAAC;IAC3B;IAEAP,GAAG,wDAAwD;QACzD,MAAMC,cAAc,IAAIC;QAExB,MAAME,SAASN,aAAaG;QAE5BI,OAAOD,OAAOI,IAAI,EAAED,IAAI,CAAC;IAC3B;AACF"}