{"version":3,"sources":["../../../src/collections/endpoints/deleteByID.ts"],"sourcesContent":["import { status as httpStatus } from 'http-status'\n\nimport type { PayloadHandler } from '../../config/types.js'\n\nimport { getRequestCollectionWithID } from '../../utilities/getRequestEntity.js'\nimport { headersWithCors } from '../../utilities/headersWithCors.js'\nimport { isNumber } from '../../utilities/isNumber.js'\nimport { sanitizePopulateParam } from '../../utilities/sanitizePopulateParam.js'\nimport { sanitizeSelectParam } from '../../utilities/sanitizeSelectParam.js'\nimport { deleteByIDOperation } from '../operations/deleteByID.js'\n\nexport const deleteByIDHandler: PayloadHandler = async (req) => {\n  const { id, collection } = getRequestCollectionWithID(req)\n  const { searchParams } = req\n  const depth = searchParams.get('depth')\n  const overrideLock = searchParams.get('overrideLock')\n  const trash = searchParams.get('trash') === 'true'\n\n  const doc = await deleteByIDOperation({\n    id,\n    collection,\n    depth: isNumber(depth) ? depth : undefined,\n    overrideLock: Boolean(overrideLock === 'true'),\n    populate: sanitizePopulateParam(req.query.populate),\n    req,\n    select: sanitizeSelectParam(req.query.select),\n    trash,\n  })\n\n  const headers = headersWithCors({\n    headers: new Headers(),\n    req,\n  })\n\n  if (!doc) {\n    return Response.json(\n      {\n        message: req.t('general:notFound'),\n      },\n      {\n        headers,\n        status: httpStatus.NOT_FOUND,\n      },\n    )\n  }\n\n  return Response.json(\n    {\n      doc,\n      message: req.t('general:deletedSuccessfully'),\n    },\n    {\n      headers,\n      status: httpStatus.OK,\n    },\n  )\n}\n"],"names":["status","httpStatus","getRequestCollectionWithID","headersWithCors","isNumber","sanitizePopulateParam","sanitizeSelectParam","deleteByIDOperation","deleteByIDHandler","req","id","collection","searchParams","depth","get","overrideLock","trash","doc","undefined","Boolean","populate","query","select","headers","Headers","Response","json","message","t","NOT_FOUND","OK"],"mappings":"AAAA,SAASA,UAAUC,UAAU,QAAQ,cAAa;AAIlD,SAASC,0BAA0B,QAAQ,sCAAqC;AAChF,SAASC,eAAe,QAAQ,qCAAoC;AACpE,SAASC,QAAQ,QAAQ,8BAA6B;AACtD,SAASC,qBAAqB,QAAQ,2CAA0C;AAChF,SAASC,mBAAmB,QAAQ,yCAAwC;AAC5E,SAASC,mBAAmB,QAAQ,8BAA6B;AAEjE,OAAO,MAAMC,oBAAoC,OAAOC;IACtD,MAAM,EAAEC,EAAE,EAAEC,UAAU,EAAE,GAAGT,2BAA2BO;IACtD,MAAM,EAAEG,YAAY,EAAE,GAAGH;IACzB,MAAMI,QAAQD,aAAaE,GAAG,CAAC;IAC/B,MAAMC,eAAeH,aAAaE,GAAG,CAAC;IACtC,MAAME,QAAQJ,aAAaE,GAAG,CAAC,aAAa;IAE5C,MAAMG,MAAM,MAAMV,oBAAoB;QACpCG;QACAC;QACAE,OAAOT,SAASS,SAASA,QAAQK;QACjCH,cAAcI,QAAQJ,iBAAiB;QACvCK,UAAUf,sBAAsBI,IAAIY,KAAK,CAACD,QAAQ;QAClDX;QACAa,QAAQhB,oBAAoBG,IAAIY,KAAK,CAACC,MAAM;QAC5CN;IACF;IAEA,MAAMO,UAAUpB,gBAAgB;QAC9BoB,SAAS,IAAIC;QACbf;IACF;IAEA,IAAI,CAACQ,KAAK;QACR,OAAOQ,SAASC,IAAI,CAClB;YACEC,SAASlB,IAAImB,CAAC,CAAC;QACjB,GACA;YACEL;YACAvB,QAAQC,WAAW4B,SAAS;QAC9B;IAEJ;IAEA,OAAOJ,SAASC,IAAI,CAClB;QACET;QACAU,SAASlB,IAAImB,CAAC,CAAC;IACjB,GACA;QACEL;QACAvB,QAAQC,WAAW6B,EAAE;IACvB;AAEJ,EAAC"}