{"version":3,"sources":["../../../src/collections/endpoints/updateByID.ts"],"sourcesContent":["import { status as httpStatus } from 'http-status'\n\nimport type { PayloadHandler } from '../../config/types.js'\n\nimport { getRequestCollectionWithID } from '../../utilities/getRequestEntity.js'\nimport { headersWithCors } from '../../utilities/headersWithCors.js'\nimport { isNumber } from '../../utilities/isNumber.js'\nimport { sanitizePopulateParam } from '../../utilities/sanitizePopulateParam.js'\nimport { sanitizeSelectParam } from '../../utilities/sanitizeSelectParam.js'\nimport { updateByIDOperation } from '../operations/updateByID.js'\n\nexport const updateByIDHandler: PayloadHandler = async (req) => {\n  const { id, collection } = getRequestCollectionWithID(req)\n  const { searchParams } = req\n  const depth = searchParams.get('depth')\n  const autosave = searchParams.get('autosave') === 'true'\n  const draft = searchParams.get('draft') === 'true'\n  const overrideLock = searchParams.get('overrideLock')\n  const trash = searchParams.get('trash') === 'true'\n  const publishSpecificLocale = req.query.publishSpecificLocale as string | undefined\n\n  const doc = await updateByIDOperation({\n    id,\n    autosave,\n    collection,\n    data: req.data!,\n    depth: isNumber(depth) ? Number(depth) : undefined,\n    draft,\n    overrideLock: Boolean(overrideLock === 'true'),\n    populate: sanitizePopulateParam(req.query.populate),\n    publishSpecificLocale,\n    req,\n    select: sanitizeSelectParam(req.query.select),\n    trash,\n  })\n\n  let message = req.t('general:updatedSuccessfully')\n\n  if (draft) {\n    message = req.t('version:draftSavedSuccessfully')\n  }\n  if (autosave) {\n    message = req.t('version:autosavedSuccessfully')\n  }\n\n  return Response.json(\n    {\n      doc,\n      message,\n    },\n    {\n      headers: headersWithCors({\n        headers: new Headers(),\n        req,\n      }),\n      status: httpStatus.OK,\n    },\n  )\n}\n"],"names":["status","httpStatus","getRequestCollectionWithID","headersWithCors","isNumber","sanitizePopulateParam","sanitizeSelectParam","updateByIDOperation","updateByIDHandler","req","id","collection","searchParams","depth","get","autosave","draft","overrideLock","trash","publishSpecificLocale","query","doc","data","Number","undefined","Boolean","populate","select","message","t","Response","json","headers","Headers","OK"],"mappings":"AAAA,SAASA,UAAUC,UAAU,QAAQ,cAAa;AAIlD,SAASC,0BAA0B,QAAQ,sCAAqC;AAChF,SAASC,eAAe,QAAQ,qCAAoC;AACpE,SAASC,QAAQ,QAAQ,8BAA6B;AACtD,SAASC,qBAAqB,QAAQ,2CAA0C;AAChF,SAASC,mBAAmB,QAAQ,yCAAwC;AAC5E,SAASC,mBAAmB,QAAQ,8BAA6B;AAEjE,OAAO,MAAMC,oBAAoC,OAAOC;IACtD,MAAM,EAAEC,EAAE,EAAEC,UAAU,EAAE,GAAGT,2BAA2BO;IACtD,MAAM,EAAEG,YAAY,EAAE,GAAGH;IACzB,MAAMI,QAAQD,aAAaE,GAAG,CAAC;IAC/B,MAAMC,WAAWH,aAAaE,GAAG,CAAC,gBAAgB;IAClD,MAAME,QAAQJ,aAAaE,GAAG,CAAC,aAAa;IAC5C,MAAMG,eAAeL,aAAaE,GAAG,CAAC;IACtC,MAAMI,QAAQN,aAAaE,GAAG,CAAC,aAAa;IAC5C,MAAMK,wBAAwBV,IAAIW,KAAK,CAACD,qBAAqB;IAE7D,MAAME,MAAM,MAAMd,oBAAoB;QACpCG;QACAK;QACAJ;QACAW,MAAMb,IAAIa,IAAI;QACdT,OAAOT,SAASS,SAASU,OAAOV,SAASW;QACzCR;QACAC,cAAcQ,QAAQR,iBAAiB;QACvCS,UAAUrB,sBAAsBI,IAAIW,KAAK,CAACM,QAAQ;QAClDP;QACAV;QACAkB,QAAQrB,oBAAoBG,IAAIW,KAAK,CAACO,MAAM;QAC5CT;IACF;IAEA,IAAIU,UAAUnB,IAAIoB,CAAC,CAAC;IAEpB,IAAIb,OAAO;QACTY,UAAUnB,IAAIoB,CAAC,CAAC;IAClB;IACA,IAAId,UAAU;QACZa,UAAUnB,IAAIoB,CAAC,CAAC;IAClB;IAEA,OAAOC,SAASC,IAAI,CAClB;QACEV;QACAO;IACF,GACA;QACEI,SAAS7B,gBAAgB;YACvB6B,SAAS,IAAIC;YACbxB;QACF;QACAT,QAAQC,WAAWiC,EAAE;IACvB;AAEJ,EAAC"}