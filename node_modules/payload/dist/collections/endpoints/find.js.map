{"version":3,"sources":["../../../src/collections/endpoints/find.ts"],"sourcesContent":["import { status as httpStatus } from 'http-status'\n\nimport type { PayloadHandler } from '../../config/types.js'\nimport type { Where } from '../../types/index.js'\nimport type { JoinParams } from '../../utilities/sanitizeJoinParams.js'\n\nimport { getRequestCollection } from '../../utilities/getRequestEntity.js'\nimport { headersWithCors } from '../../utilities/headersWithCors.js'\nimport { isNumber } from '../../utilities/isNumber.js'\nimport { sanitizeJoinParams } from '../../utilities/sanitizeJoinParams.js'\nimport { sanitizePopulateParam } from '../../utilities/sanitizePopulateParam.js'\nimport { sanitizeSelectParam } from '../../utilities/sanitizeSelectParam.js'\nimport { findOperation } from '../operations/find.js'\n\nexport const findHandler: PayloadHandler = async (req) => {\n  const collection = getRequestCollection(req)\n  const { depth, draft, joins, limit, page, pagination, populate, select, sort, trash, where } =\n    req.query as {\n      depth?: string\n      draft?: string\n      joins?: JoinParams\n      limit?: string\n      page?: string\n      pagination?: string\n      populate?: Record<string, unknown>\n      select?: Record<string, unknown>\n      sort?: string\n      trash?: string\n      where?: Where\n    }\n\n  const result = await findOperation({\n    collection,\n    depth: isNumber(depth) ? Number(depth) : undefined,\n    draft: draft === 'true',\n    joins: sanitizeJoinParams(joins),\n    limit: isNumber(limit) ? Number(limit) : undefined,\n    page: isNumber(page) ? Number(page) : undefined,\n    pagination: pagination === 'false' ? false : undefined,\n    populate: sanitizePopulateParam(populate),\n    req,\n    select: sanitizeSelectParam(select),\n    sort: typeof sort === 'string' ? sort.split(',') : undefined,\n    trash: trash === 'true',\n    where,\n  })\n\n  return Response.json(result, {\n    headers: headersWithCors({\n      headers: new Headers(),\n      req,\n    }),\n    status: httpStatus.OK,\n  })\n}\n"],"names":["status","httpStatus","getRequestCollection","headersWithCors","isNumber","sanitizeJoinParams","sanitizePopulateParam","sanitizeSelectParam","findOperation","findHandler","req","collection","depth","draft","joins","limit","page","pagination","populate","select","sort","trash","where","query","result","Number","undefined","split","Response","json","headers","Headers","OK"],"mappings":"AAAA,SAASA,UAAUC,UAAU,QAAQ,cAAa;AAMlD,SAASC,oBAAoB,QAAQ,sCAAqC;AAC1E,SAASC,eAAe,QAAQ,qCAAoC;AACpE,SAASC,QAAQ,QAAQ,8BAA6B;AACtD,SAASC,kBAAkB,QAAQ,wCAAuC;AAC1E,SAASC,qBAAqB,QAAQ,2CAA0C;AAChF,SAASC,mBAAmB,QAAQ,yCAAwC;AAC5E,SAASC,aAAa,QAAQ,wBAAuB;AAErD,OAAO,MAAMC,cAA8B,OAAOC;IAChD,MAAMC,aAAaT,qBAAqBQ;IACxC,MAAM,EAAEE,KAAK,EAAEC,KAAK,EAAEC,KAAK,EAAEC,KAAK,EAAEC,IAAI,EAAEC,UAAU,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,IAAI,EAAEC,KAAK,EAAEC,KAAK,EAAE,GAC1FZ,IAAIa,KAAK;IAcX,MAAMC,SAAS,MAAMhB,cAAc;QACjCG;QACAC,OAAOR,SAASQ,SAASa,OAAOb,SAASc;QACzCb,OAAOA,UAAU;QACjBC,OAAOT,mBAAmBS;QAC1BC,OAAOX,SAASW,SAASU,OAAOV,SAASW;QACzCV,MAAMZ,SAASY,QAAQS,OAAOT,QAAQU;QACtCT,YAAYA,eAAe,UAAU,QAAQS;QAC7CR,UAAUZ,sBAAsBY;QAChCR;QACAS,QAAQZ,oBAAoBY;QAC5BC,MAAM,OAAOA,SAAS,WAAWA,KAAKO,KAAK,CAAC,OAAOD;QACnDL,OAAOA,UAAU;QACjBC;IACF;IAEA,OAAOM,SAASC,IAAI,CAACL,QAAQ;QAC3BM,SAAS3B,gBAAgB;YACvB2B,SAAS,IAAIC;YACbrB;QACF;QACAV,QAAQC,WAAW+B,EAAE;IACvB;AACF,EAAC"}