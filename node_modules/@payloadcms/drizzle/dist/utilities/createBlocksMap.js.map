{"version":3,"sources":["../../src/utilities/createBlocksMap.ts"],"sourcesContent":["export type BlocksMap = {\n  [path: string]: Record<string, unknown>[]\n}\n\nexport const createBlocksMap = (data: Record<string, unknown>): BlocksMap => {\n  const blocksMap: BlocksMap = {}\n\n  Object.entries(data).forEach(([key, rows]) => {\n    if (key.startsWith('_blocks_') && Array.isArray(rows)) {\n      let blockType = key.replace('_blocks_', '')\n      const parsed = blockType.split('_')\n      if (parsed.length === 2 && Number.isInteger(Number(parsed[1]))) {\n        blockType = parsed[0]\n      }\n\n      rows.forEach((row) => {\n        if ('_path' in row) {\n          if (!(row._path in blocksMap)) {\n            blocksMap[row._path] = []\n          }\n\n          row.blockType = blockType\n          blocksMap[row._path].push(row)\n\n          delete row._path\n        }\n      })\n\n      delete data[key]\n    }\n  })\n\n  Object.entries(blocksMap).reduce((sortedBlocksMap, [path, blocks]) => {\n    sortedBlocksMap[path] = blocks.sort((a, b) => {\n      if (typeof a._order === 'number' && typeof b._order === 'number') {\n        return a._order - b._order\n      }\n\n      return 0\n    })\n\n    return sortedBlocksMap\n  }, {})\n\n  return blocksMap\n}\n"],"names":["createBlocksMap","data","blocksMap","Object","entries","forEach","key","rows","startsWith","Array","isArray","blockType","replace","parsed","split","length","Number","isInteger","row","_path","push","reduce","sortedBlocksMap","path","blocks","sort","a","b","_order"],"mappings":"AAIA,OAAO,MAAMA,kBAAkB,CAACC;IAC9B,MAAMC,YAAuB,CAAC;IAE9BC,OAAOC,OAAO,CAACH,MAAMI,OAAO,CAAC,CAAC,CAACC,KAAKC,KAAK;QACvC,IAAID,IAAIE,UAAU,CAAC,eAAeC,MAAMC,OAAO,CAACH,OAAO;YACrD,IAAII,YAAYL,IAAIM,OAAO,CAAC,YAAY;YACxC,MAAMC,SAASF,UAAUG,KAAK,CAAC;YAC/B,IAAID,OAAOE,MAAM,KAAK,KAAKC,OAAOC,SAAS,CAACD,OAAOH,MAAM,CAAC,EAAE,IAAI;gBAC9DF,YAAYE,MAAM,CAAC,EAAE;YACvB;YAEAN,KAAKF,OAAO,CAAC,CAACa;gBACZ,IAAI,WAAWA,KAAK;oBAClB,IAAI,CAAEA,CAAAA,IAAIC,KAAK,IAAIjB,SAAQ,GAAI;wBAC7BA,SAAS,CAACgB,IAAIC,KAAK,CAAC,GAAG,EAAE;oBAC3B;oBAEAD,IAAIP,SAAS,GAAGA;oBAChBT,SAAS,CAACgB,IAAIC,KAAK,CAAC,CAACC,IAAI,CAACF;oBAE1B,OAAOA,IAAIC,KAAK;gBAClB;YACF;YAEA,OAAOlB,IAAI,CAACK,IAAI;QAClB;IACF;IAEAH,OAAOC,OAAO,CAACF,WAAWmB,MAAM,CAAC,CAACC,iBAAiB,CAACC,MAAMC,OAAO;QAC/DF,eAAe,CAACC,KAAK,GAAGC,OAAOC,IAAI,CAAC,CAACC,GAAGC;YACtC,IAAI,OAAOD,EAAEE,MAAM,KAAK,YAAY,OAAOD,EAAEC,MAAM,KAAK,UAAU;gBAChE,OAAOF,EAAEE,MAAM,GAAGD,EAAEC,MAAM;YAC5B;YAEA,OAAO;QACT;QAEA,OAAON;IACT,GAAG,CAAC;IAEJ,OAAOpB;AACT,EAAC"}