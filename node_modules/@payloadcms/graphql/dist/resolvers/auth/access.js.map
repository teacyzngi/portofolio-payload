{"version":3,"sources":["../../../src/resolvers/auth/access.ts"],"sourcesContent":["import type { SanitizedConfig } from 'payload'\n\nimport { accessOperation, isolateObjectProperty } from 'payload'\n\nimport type { Context } from '../types.js'\n\nimport { formatName } from '../../utilities/formatName.js'\nconst formatConfigNames = (results, configs) => {\n  const formattedResults = { ...results }\n\n  configs.forEach(({ slug }) => {\n    const result = { ...(formattedResults[slug] || {}) }\n    delete formattedResults[slug]\n    formattedResults[formatName(slug)] = result\n  })\n\n  return formattedResults\n}\n\nexport function accessResolver(config: SanitizedConfig) {\n  async function resolver(_, args, context: Context) {\n    const options = {\n      req: isolateObjectProperty<any>(context.req, 'transactionID'),\n    }\n\n    const accessResults = await accessOperation(options)\n\n    return {\n      ...accessResults,\n      ...formatConfigNames(accessResults.collections, config.collections),\n      ...formatConfigNames(accessResults.globals, config.globals),\n    }\n  }\n\n  return resolver\n}\n"],"names":["accessOperation","isolateObjectProperty","formatName","formatConfigNames","results","configs","formattedResults","forEach","slug","result","accessResolver","config","resolver","_","args","context","options","req","accessResults","collections","globals"],"mappings":"AAEA,SAASA,eAAe,EAAEC,qBAAqB,QAAQ,UAAS;AAIhE,SAASC,UAAU,QAAQ,gCAA+B;AAC1D,MAAMC,oBAAoB,CAACC,SAASC;IAClC,MAAMC,mBAAmB;QAAE,GAAGF,OAAO;IAAC;IAEtCC,QAAQE,OAAO,CAAC,CAAC,EAAEC,IAAI,EAAE;QACvB,MAAMC,SAAS;YAAE,GAAIH,gBAAgB,CAACE,KAAK,IAAI,CAAC,CAAC;QAAE;QACnD,OAAOF,gBAAgB,CAACE,KAAK;QAC7BF,gBAAgB,CAACJ,WAAWM,MAAM,GAAGC;IACvC;IAEA,OAAOH;AACT;AAEA,OAAO,SAASI,eAAeC,MAAuB;IACpD,eAAeC,SAASC,CAAC,EAAEC,IAAI,EAAEC,OAAgB;QAC/C,MAAMC,UAAU;YACdC,KAAKhB,sBAA2Bc,QAAQE,GAAG,EAAE;QAC/C;QAEA,MAAMC,gBAAgB,MAAMlB,gBAAgBgB;QAE5C,OAAO;YACL,GAAGE,aAAa;YAChB,GAAGf,kBAAkBe,cAAcC,WAAW,EAAER,OAAOQ,WAAW,CAAC;YACnE,GAAGhB,kBAAkBe,cAAcE,OAAO,EAAET,OAAOS,OAAO,CAAC;QAC7D;IACF;IAEA,OAAOR;AACT"}