{"version":3,"sources":["../../../src/resolvers/auth/login.ts"],"sourcesContent":["import type { Collection } from 'payload'\n\nimport { generatePayloadCookie, isolateObjectProperty, loginOperation } from 'payload'\n\nimport type { Context } from '../types.js'\n\nexport function login(collection: Collection): any {\n  async function resolver(_, args, context: Context) {\n    const options = {\n      collection,\n      data: {\n        email: args.email,\n        password: args.password,\n        username: args.username,\n      },\n      depth: 0,\n      req: isolateObjectProperty(context.req, 'transactionID'),\n    }\n\n    const result = await loginOperation(options)\n    const cookie = generatePayloadCookie({\n      collectionAuthConfig: collection.config.auth,\n      cookiePrefix: context.req.payload.config.cookiePrefix,\n      token: result.token,\n    })\n\n    context.headers['Set-Cookie'] = cookie\n\n    if (collection.config.auth.removeTokenFromResponses) {\n      delete result.token\n    }\n\n    return result\n  }\n\n  return resolver\n}\n"],"names":["generatePayloadCookie","isolateObjectProperty","loginOperation","login","collection","resolver","_","args","context","options","data","email","password","username","depth","req","result","cookie","collectionAuthConfig","config","auth","cookiePrefix","payload","token","headers","removeTokenFromResponses"],"mappings":"AAEA,SAASA,qBAAqB,EAAEC,qBAAqB,EAAEC,cAAc,QAAQ,UAAS;AAItF,OAAO,SAASC,MAAMC,UAAsB;IAC1C,eAAeC,SAASC,CAAC,EAAEC,IAAI,EAAEC,OAAgB;QAC/C,MAAMC,UAAU;YACdL;YACAM,MAAM;gBACJC,OAAOJ,KAAKI,KAAK;gBACjBC,UAAUL,KAAKK,QAAQ;gBACvBC,UAAUN,KAAKM,QAAQ;YACzB;YACAC,OAAO;YACPC,KAAKd,sBAAsBO,QAAQO,GAAG,EAAE;QAC1C;QAEA,MAAMC,SAAS,MAAMd,eAAeO;QACpC,MAAMQ,SAASjB,sBAAsB;YACnCkB,sBAAsBd,WAAWe,MAAM,CAACC,IAAI;YAC5CC,cAAcb,QAAQO,GAAG,CAACO,OAAO,CAACH,MAAM,CAACE,YAAY;YACrDE,OAAOP,OAAOO,KAAK;QACrB;QAEAf,QAAQgB,OAAO,CAAC,aAAa,GAAGP;QAEhC,IAAIb,WAAWe,MAAM,CAACC,IAAI,CAACK,wBAAwB,EAAE;YACnD,OAAOT,OAAOO,KAAK;QACrB;QAEA,OAAOP;IACT;IAEA,OAAOX;AACT"}