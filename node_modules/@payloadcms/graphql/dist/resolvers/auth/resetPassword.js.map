{"version":3,"sources":["../../../src/resolvers/auth/resetPassword.ts"],"sourcesContent":["import type { Collection } from 'payload'\n\nimport { generatePayloadCookie, isolateObjectProperty, resetPasswordOperation } from 'payload'\n\nimport type { Context } from '../types.js'\n\nexport function resetPassword(collection: Collection): any {\n  async function resolver(_, args, context: Context) {\n    if (args.locale) {\n      context.req.locale = args.locale\n    }\n    if (args.fallbackLocale) {\n      context.req.fallbackLocale = args.fallbackLocale\n    }\n\n    const options = {\n      api: 'GraphQL',\n      collection,\n      data: args,\n      depth: 0,\n      req: isolateObjectProperty(context.req, 'transactionID'),\n    }\n\n    const result = await resetPasswordOperation(options)\n    const cookie = generatePayloadCookie({\n      collectionAuthConfig: collection.config.auth,\n      cookiePrefix: context.req.payload.config.cookiePrefix,\n      token: result.token,\n    })\n    context.headers['Set-Cookie'] = cookie\n\n    if (collection.config.auth.removeTokenFromResponses) {\n      delete result.token\n    }\n\n    return result\n  }\n\n  return resolver\n}\n"],"names":["generatePayloadCookie","isolateObjectProperty","resetPasswordOperation","resetPassword","collection","resolver","_","args","context","locale","req","fallbackLocale","options","api","data","depth","result","cookie","collectionAuthConfig","config","auth","cookiePrefix","payload","token","headers","removeTokenFromResponses"],"mappings":"AAEA,SAASA,qBAAqB,EAAEC,qBAAqB,EAAEC,sBAAsB,QAAQ,UAAS;AAI9F,OAAO,SAASC,cAAcC,UAAsB;IAClD,eAAeC,SAASC,CAAC,EAAEC,IAAI,EAAEC,OAAgB;QAC/C,IAAID,KAAKE,MAAM,EAAE;YACfD,QAAQE,GAAG,CAACD,MAAM,GAAGF,KAAKE,MAAM;QAClC;QACA,IAAIF,KAAKI,cAAc,EAAE;YACvBH,QAAQE,GAAG,CAACC,cAAc,GAAGJ,KAAKI,cAAc;QAClD;QAEA,MAAMC,UAAU;YACdC,KAAK;YACLT;YACAU,MAAMP;YACNQ,OAAO;YACPL,KAAKT,sBAAsBO,QAAQE,GAAG,EAAE;QAC1C;QAEA,MAAMM,SAAS,MAAMd,uBAAuBU;QAC5C,MAAMK,SAASjB,sBAAsB;YACnCkB,sBAAsBd,WAAWe,MAAM,CAACC,IAAI;YAC5CC,cAAcb,QAAQE,GAAG,CAACY,OAAO,CAACH,MAAM,CAACE,YAAY;YACrDE,OAAOP,OAAOO,KAAK;QACrB;QACAf,QAAQgB,OAAO,CAAC,aAAa,GAAGP;QAEhC,IAAIb,WAAWe,MAAM,CAACC,IAAI,CAACK,wBAAwB,EAAE;YACnD,OAAOT,OAAOO,KAAK;QACrB;QAEA,OAAOP;IACT;IAEA,OAAOX;AACT"}