{"version":3,"file":"index.js","names":["RenderServerComponent","redirect","getSafeRedirect","React","Fragment","Logo","LoginForm","loginBaseClass","LoginView","initPageResult","params","searchParams","locale","permissions","req","i18n","payload","config","user","admin","components","afterLogin","beforeLogin","userSlug","routes","redirectUrl","fallbackTo","redirectTo","collectionConfig","collections","prefillAutoLogin","autoLogin","prefillOnly","prefillUsername","username","undefined","prefillEmail","email","prefillPassword","password","_jsxs","_jsx","className","Component","importMap","serverProps","auth","disableLocalStrategy"],"sources":["../../../src/views/Login/index.tsx"],"sourcesContent":["import type { AdminViewServerProps, ServerProps } from 'payload'\n\nimport { RenderServerComponent } from '@payloadcms/ui/elements/RenderServerComponent'\nimport { redirect } from 'next/navigation.js'\nimport { getSafeRedirect } from 'payload/shared'\nimport React, { Fragment } from 'react'\n\nimport { Logo } from '../../elements/Logo/index.js'\nimport { LoginForm } from './LoginForm/index.js'\nimport './index.scss'\nexport const loginBaseClass = 'login'\n\nexport function LoginView({ initPageResult, params, searchParams }: AdminViewServerProps) {\n  const { locale, permissions, req } = initPageResult\n\n  const {\n    i18n,\n    payload: { config },\n    payload,\n    user,\n  } = req\n\n  const {\n    admin: { components: { afterLogin, beforeLogin } = {}, user: userSlug },\n    routes: { admin },\n  } = config\n\n  const redirectUrl = getSafeRedirect({ fallbackTo: admin, redirectTo: searchParams.redirect })\n\n  if (user) {\n    redirect(redirectUrl)\n  }\n\n  const collectionConfig = payload?.collections?.[userSlug]?.config\n\n  const prefillAutoLogin =\n    typeof config.admin?.autoLogin === 'object' && config.admin?.autoLogin.prefillOnly\n\n  const prefillUsername =\n    prefillAutoLogin && typeof config.admin?.autoLogin === 'object'\n      ? config.admin?.autoLogin.username\n      : undefined\n\n  const prefillEmail =\n    prefillAutoLogin && typeof config.admin?.autoLogin === 'object'\n      ? config.admin?.autoLogin.email\n      : undefined\n\n  const prefillPassword =\n    prefillAutoLogin && typeof config.admin?.autoLogin === 'object'\n      ? config.admin?.autoLogin.password\n      : undefined\n\n  return (\n    <Fragment>\n      <div className={`${loginBaseClass}__brand`}>\n        <Logo\n          i18n={i18n}\n          locale={locale}\n          params={params}\n          payload={payload}\n          permissions={permissions}\n          searchParams={searchParams}\n          user={user}\n        />\n      </div>\n      {RenderServerComponent({\n        Component: beforeLogin,\n        importMap: payload.importMap,\n        serverProps: {\n          i18n,\n          locale,\n          params,\n          payload,\n          permissions,\n          searchParams,\n          user,\n        } satisfies ServerProps,\n      })}\n      {!collectionConfig?.auth?.disableLocalStrategy && (\n        <LoginForm\n          prefillEmail={prefillEmail}\n          prefillPassword={prefillPassword}\n          prefillUsername={prefillUsername}\n          searchParams={searchParams}\n        />\n      )}\n      {RenderServerComponent({\n        Component: afterLogin,\n        importMap: payload.importMap,\n        serverProps: {\n          i18n,\n          locale,\n          params,\n          payload,\n          permissions,\n          searchParams,\n          user,\n        } satisfies ServerProps,\n      })}\n    </Fragment>\n  )\n}\n"],"mappings":"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","ignoreList":[]}