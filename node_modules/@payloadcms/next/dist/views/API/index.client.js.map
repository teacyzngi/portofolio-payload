{"version":3,"file":"index.client.js","names":["CheckboxField","CopyToClipboard","Form","Gutter","MinimizeMaximizeIcon","NumberField","SetDocumentStepNav","toast","useConfig","useDocumentInfo","useLocale","useTranslation","useSearchParams","React","LocaleSelector","RenderJSON","baseClass","APIViewClient","id","collectionSlug","globalSlug","initialData","isTrashed","searchParams","i18n","t","code","config","defaultDepth","localization","routes","api","apiRoute","serverURL","getEntityConfig","collectionConfig","globalConfig","localeOptions","locales","map","locale","label","value","draftsEnabled","docEndpoint","Boolean","versions","drafts","data","setData","useState","draft","setDraft","get","setLocale","depth","setDepth","toString","authenticated","setAuthenticated","fullscreen","setFullscreen","trashParam","deletedAt","params","URLSearchParams","String","trash","fetchURL","useEffect","fetchData","res","fetch","credentials","headers","language","method","json","error","console","_jsxs","className","filter","join","right","_jsx","globalLabel","pluralLabel","labels","plural","undefined","useAsTitle","admin","view","href","rel","target","initialState","initialValue","valid","Number","field","name","onChange","path","step","max","min","onClick","type","isMinimized","object"],"sources":["../../../src/views/API/index.client.tsx"],"sourcesContent":["'use client'\n\nimport {\n  CheckboxField,\n  CopyToClipboard,\n  Form,\n  Gutter,\n  MinimizeMaximizeIcon,\n  NumberField,\n  SetDocumentStepNav,\n  toast,\n  useConfig,\n  useDocumentInfo,\n  useLocale,\n  useTranslation,\n} from '@payloadcms/ui'\nimport { useSearchParams } from 'next/navigation.js'\n\nimport './index.scss'\n\nimport * as React from 'react'\n\nimport { LocaleSelector } from './LocaleSelector/index.js'\nimport { RenderJSON } from './RenderJSON/index.js'\n\nconst baseClass = 'query-inspector'\n\nexport const APIViewClient: React.FC = () => {\n  const { id, collectionSlug, globalSlug, initialData, isTrashed } = useDocumentInfo()\n\n  const searchParams = useSearchParams()\n  const { i18n, t } = useTranslation()\n  const { code } = useLocale()\n\n  const {\n    config: {\n      defaultDepth,\n      localization,\n      routes: { api: apiRoute },\n      serverURL,\n    },\n    getEntityConfig,\n  } = useConfig()\n\n  const collectionConfig = getEntityConfig({ collectionSlug })\n  const globalConfig = getEntityConfig({ globalSlug })\n\n  const localeOptions =\n    localization &&\n    localization.locales.map((locale) => ({ label: locale.label, value: locale.code }))\n\n  let draftsEnabled: boolean = false\n  let docEndpoint: string = ''\n\n  if (collectionConfig) {\n    draftsEnabled = Boolean(collectionConfig.versions?.drafts)\n    docEndpoint = `/${collectionSlug}/${id}`\n  }\n\n  if (globalConfig) {\n    draftsEnabled = Boolean(globalConfig.versions?.drafts)\n    docEndpoint = `/globals/${globalSlug}`\n  }\n\n  const [data, setData] = React.useState<any>(initialData)\n  const [draft, setDraft] = React.useState<boolean>(searchParams.get('draft') === 'true')\n  const [locale, setLocale] = React.useState<string>(searchParams?.get('locale') || code)\n  const [depth, setDepth] = React.useState<string>(\n    searchParams.get('depth') || defaultDepth.toString(),\n  )\n  const [authenticated, setAuthenticated] = React.useState<boolean>(true)\n  const [fullscreen, setFullscreen] = React.useState<boolean>(false)\n\n  const trashParam = typeof initialData?.deletedAt === 'string'\n\n  const params = new URLSearchParams({\n    depth,\n    draft: String(draft),\n    locale,\n    trash: trashParam ? 'true' : 'false',\n  }).toString()\n\n  const fetchURL = `${serverURL}${apiRoute}${docEndpoint}?${params}`\n\n  React.useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const res = await fetch(fetchURL, {\n          credentials: authenticated ? 'include' : 'omit',\n          headers: {\n            'Accept-Language': i18n.language,\n          },\n          method: 'GET',\n        })\n\n        try {\n          const json = await res.json()\n          setData(json)\n        } catch (error) {\n          toast.error('Error parsing response')\n          console.error(error) // eslint-disable-line no-console\n        }\n      } catch (error) {\n        toast.error('Error making request')\n        console.error(error) // eslint-disable-line no-console\n      }\n    }\n\n    void fetchData()\n  }, [i18n.language, fetchURL, authenticated])\n\n  return (\n    <Gutter\n      className={[baseClass, fullscreen && `${baseClass}--fullscreen`].filter(Boolean).join(' ')}\n      right={false}\n    >\n      <SetDocumentStepNav\n        collectionSlug={collectionSlug}\n        globalLabel={globalConfig?.label}\n        globalSlug={globalSlug}\n        id={id}\n        isTrashed={isTrashed}\n        pluralLabel={collectionConfig ? collectionConfig?.labels?.plural : undefined}\n        useAsTitle={collectionConfig ? collectionConfig?.admin?.useAsTitle : undefined}\n        view=\"API\"\n      />\n      <div className={`${baseClass}__configuration`}>\n        <div className={`${baseClass}__api-url`}>\n          <span className={`${baseClass}__label`}>\n            API URL <CopyToClipboard value={fetchURL} />\n          </span>\n          <a href={fetchURL} rel=\"noopener noreferrer\" target=\"_blank\">\n            {fetchURL}\n          </a>\n        </div>\n        <Form\n          initialState={{\n            authenticated: {\n              initialValue: authenticated || false,\n              valid: true,\n              value: authenticated || false,\n            },\n            depth: {\n              initialValue: Number(depth || 0),\n              valid: true,\n              value: Number(depth || 0),\n            },\n            draft: {\n              initialValue: draft || false,\n              valid: true,\n              value: draft || false,\n            },\n            locale: {\n              initialValue: locale,\n              valid: true,\n              value: locale,\n            },\n          }}\n        >\n          <div className={`${baseClass}__form-fields`}>\n            <div className={`${baseClass}__filter-query-checkboxes`}>\n              {draftsEnabled && (\n                <CheckboxField\n                  field={{\n                    name: 'draft',\n                    label: t('version:draft'),\n                  }}\n                  onChange={() => setDraft(!draft)}\n                  path=\"draft\"\n                />\n              )}\n              <CheckboxField\n                field={{\n                  name: 'authenticated',\n                  label: t('authentication:authenticated'),\n                }}\n                onChange={() => setAuthenticated(!authenticated)}\n                path=\"authenticated\"\n              />\n            </div>\n            {localeOptions && <LocaleSelector localeOptions={localeOptions} onChange={setLocale} />}\n            <NumberField\n              field={{\n                name: 'depth',\n                admin: {\n                  step: 1,\n                },\n                label: t('general:depth'),\n                max: 10,\n                min: 0,\n              }}\n              onChange={(value) => setDepth(value?.toString())}\n              path=\"depth\"\n            />\n          </div>\n        </Form>\n      </div>\n      <div className={`${baseClass}__results-wrapper`}>\n        <div className={`${baseClass}__toggle-fullscreen-button-container`}>\n          <button\n            aria-label=\"toggle fullscreen\"\n            className={`${baseClass}__toggle-fullscreen-button`}\n            onClick={() => setFullscreen(!fullscreen)}\n            type=\"button\"\n          >\n            <MinimizeMaximizeIcon isMinimized={!fullscreen} />\n          </button>\n        </div>\n        <div className={`${baseClass}__results`}>\n          <RenderJSON object={data} />\n        </div>\n      </div>\n    </Gutter>\n  )\n}\n"],"mappings":"AAAA;;;AAEA,SACEA,aAAa,EACbC,eAAe,EACfC,IAAI,EACJC,MAAM,EACNC,oBAAoB,EACpBC,WAAW,EACXC,kBAAkB,EAClBC,KAAK,EACLC,SAAS,EACTC,eAAe,EACfC,SAAS,EACTC,cAAc,QACT;AACP,SAASC,eAAe,QAAQ;AAIhC,YAAYC,KAAA,MAAW;AAEvB,SAASC,cAAc,QAAQ;AAC/B,SAASC,UAAU,QAAQ;AAE3B,MAAMC,SAAA,GAAY;AAElB,OAAO,MAAMC,aAAA,GAA0BA,CAAA;EACrC,MAAM;IAAEC,EAAE;IAAEC,cAAc;IAAEC,UAAU;IAAEC,WAAW;IAAEC;EAAS,CAAE,GAAGb,eAAA;EAEnE,MAAMc,YAAA,GAAeX,eAAA;EACrB,MAAM;IAAEY,IAAI;IAAEC;EAAC,CAAE,GAAGd,cAAA;EACpB,MAAM;IAAEe;EAAI,CAAE,GAAGhB,SAAA;EAEjB,MAAM;IACJiB,MAAA,EAAQ;MACNC,YAAY;MACZC,YAAY;MACZC,MAAA,EAAQ;QAAEC,GAAA,EAAKC;MAAQ,CAAE;MACzBC;IAAS,CACV;IACDC;EAAe,CAChB,GAAG1B,SAAA;EAEJ,MAAM2B,gBAAA,GAAmBD,eAAA,CAAgB;IAAEf;EAAe;EAC1D,MAAMiB,YAAA,GAAeF,eAAA,CAAgB;IAAEd;EAAW;EAElD,MAAMiB,aAAA,GACJR,YAAA,IACAA,YAAA,CAAaS,OAAO,CAACC,GAAG,CAAEC,MAAA,KAAY;IAAEC,KAAA,EAAOD,MAAA,CAAOC,KAAK;IAAEC,KAAA,EAAOF,MAAA,CAAOd;EAAK;EAElF,IAAIiB,aAAA,GAAyB;EAC7B,IAAIC,WAAA,GAAsB;EAE1B,IAAIT,gBAAA,EAAkB;IACpBQ,aAAA,GAAgBE,OAAA,CAAQV,gBAAA,CAAiBW,QAAQ,EAAEC,MAAA;IACnDH,WAAA,GAAc,IAAIzB,cAAA,IAAkBD,EAAA,EAAI;EAC1C;EAEA,IAAIkB,YAAA,EAAc;IAChBO,aAAA,GAAgBE,OAAA,CAAQT,YAAA,CAAaU,QAAQ,EAAEC,MAAA;IAC/CH,WAAA,GAAc,YAAYxB,UAAA,EAAY;EACxC;EAEA,MAAM,CAAC4B,IAAA,EAAMC,OAAA,CAAQ,GAAGpC,KAAA,CAAMqC,QAAQ,CAAM7B,WAAA;EAC5C,MAAM,CAAC8B,KAAA,EAAOC,QAAA,CAAS,GAAGvC,KAAA,CAAMqC,QAAQ,CAAU3B,YAAA,CAAa8B,GAAG,CAAC,aAAa;EAChF,MAAM,CAACb,QAAA,EAAQc,SAAA,CAAU,GAAGzC,KAAA,CAAMqC,QAAQ,CAAS3B,YAAA,EAAc8B,GAAA,CAAI,aAAa3B,IAAA;EAClF,MAAM,CAAC6B,KAAA,EAAOC,QAAA,CAAS,GAAG3C,KAAA,CAAMqC,QAAQ,CACtC3B,YAAA,CAAa8B,GAAG,CAAC,YAAYzB,YAAA,CAAa6B,QAAQ;EAEpD,MAAM,CAACC,aAAA,EAAeC,gBAAA,CAAiB,GAAG9C,KAAA,CAAMqC,QAAQ,CAAU;EAClE,MAAM,CAACU,UAAA,EAAYC,aAAA,CAAc,GAAGhD,KAAA,CAAMqC,QAAQ,CAAU;EAE5D,MAAMY,UAAA,GAAa,OAAOzC,WAAA,EAAa0C,SAAA,KAAc;EAErD,MAAMC,MAAA,GAAS,IAAIC,eAAA,CAAgB;IACjCV,KAAA;IACAJ,KAAA,EAAOe,MAAA,CAAOf,KAAA;IACdX,MAAA,EAAAA,QAAA;IACA2B,KAAA,EAAOL,UAAA,GAAa,SAAS;EAC/B,GAAGL,QAAQ;EAEX,MAAMW,QAAA,GAAW,GAAGnC,SAAA,GAAYD,QAAA,GAAWY,WAAA,IAAeoB,MAAA,EAAQ;EAElEnD,KAAA,CAAMwD,SAAS,CAAC;IACd,MAAMC,SAAA,GAAY,MAAAA,CAAA;MAChB,IAAI;QACF,MAAMC,GAAA,GAAM,MAAMC,KAAA,CAAMJ,QAAA,EAAU;UAChCK,WAAA,EAAaf,aAAA,GAAgB,YAAY;UACzCgB,OAAA,EAAS;YACP,mBAAmBlD,IAAA,CAAKmD;UAC1B;UACAC,MAAA,EAAQ;QACV;QAEA,IAAI;UACF,MAAMC,IAAA,GAAO,MAAMN,GAAA,CAAIM,IAAI;UAC3B5B,OAAA,CAAQ4B,IAAA;QACV,EAAE,OAAOC,OAAA,EAAO;UACdvE,KAAA,CAAMuE,KAAK,CAAC;UACZC,OAAA,CAAQD,KAAK,CAACA,OAAA,EAAO;UAAA;QACvB;MACF,EAAE,OAAOA,KAAA,EAAO;QACdvE,KAAA,CAAMuE,KAAK,CAAC;QACZC,OAAA,CAAQD,KAAK,CAACA,KAAA,EAAO;QAAA;MACvB;IACF;IAEA,KAAKR,SAAA;EACP,GAAG,CAAC9C,IAAA,CAAKmD,QAAQ,EAAEP,QAAA,EAAUV,aAAA,CAAc;EAE3C,oBACEsB,KAAA,CAAC7E,MAAA;IACC8E,SAAA,EAAW,CAACjE,SAAA,EAAW4C,UAAA,IAAc,GAAG5C,SAAA,cAAuB,CAAC,CAACkE,MAAM,CAACrC,OAAA,EAASsC,IAAI,CAAC;IACtFC,KAAA,EAAO;4BAEPC,IAAA,CAAC/E,kBAAA;MACCa,cAAA,EAAgBA,cAAA;MAChBmE,WAAA,EAAalD,YAAA,EAAcK,KAAA;MAC3BrB,UAAA,EAAYA,UAAA;MACZF,EAAA,EAAIA,EAAA;MACJI,SAAA,EAAWA,SAAA;MACXiE,WAAA,EAAapD,gBAAA,GAAmBA,gBAAA,EAAkBqD,MAAA,EAAQC,MAAA,GAASC,SAAA;MACnEC,UAAA,EAAYxD,gBAAA,GAAmBA,gBAAA,EAAkByD,KAAA,EAAOD,UAAA,GAAaD,SAAA;MACrEG,IAAA,EAAK;qBAEPb,KAAA,CAAC;MAAIC,SAAA,EAAW,GAAGjE,SAAA,iBAA0B;8BAC3CgE,KAAA,CAAC;QAAIC,SAAA,EAAW,GAAGjE,SAAA,WAAoB;gCACrCgE,KAAA,CAAC;UAAKC,SAAA,EAAW,GAAGjE,SAAA,SAAkB;qBAAE,Y,aAC9BqE,IAAA,CAACpF,eAAA;YAAgByC,KAAA,EAAO0B;;yBAElCiB,IAAA,CAAC;UAAES,IAAA,EAAM1B,QAAA;UAAU2B,GAAA,EAAI;UAAsBC,MAAA,EAAO;oBACjD5B;;uBAGLiB,IAAA,CAACnF,IAAA;QACC+F,YAAA,EAAc;UACZvC,aAAA,EAAe;YACbwC,YAAA,EAAcxC,aAAA,IAAiB;YAC/ByC,KAAA,EAAO;YACPzD,KAAA,EAAOgB,aAAA,IAAiB;UAC1B;UACAH,KAAA,EAAO;YACL2C,YAAA,EAAcE,MAAA,CAAO7C,KAAA,IAAS;YAC9B4C,KAAA,EAAO;YACPzD,KAAA,EAAO0D,MAAA,CAAO7C,KAAA,IAAS;UACzB;UACAJ,KAAA,EAAO;YACL+C,YAAA,EAAc/C,KAAA,IAAS;YACvBgD,KAAA,EAAO;YACPzD,KAAA,EAAOS,KAAA,IAAS;UAClB;UACAX,MAAA,EAAQ;YACN0D,YAAA,EAAc1D,QAAA;YACd2D,KAAA,EAAO;YACPzD,KAAA,EAAOF;UACT;QACF;kBAEA,aAAAwC,KAAA,CAAC;UAAIC,SAAA,EAAW,GAAGjE,SAAA,eAAwB;kCACzCgE,KAAA,CAAC;YAAIC,SAAA,EAAW,GAAGjE,SAAA,2BAAoC;uBACpD2B,aAAA,iBACC0C,IAAA,CAACrF,aAAA;cACCqG,KAAA,EAAO;gBACLC,IAAA,EAAM;gBACN7D,KAAA,EAAOhB,CAAA,CAAE;cACX;cACA8E,QAAA,EAAUA,CAAA,KAAMnD,QAAA,CAAS,CAACD,KAAA;cAC1BqD,IAAA,EAAK;6BAGTnB,IAAA,CAACrF,aAAA;cACCqG,KAAA,EAAO;gBACLC,IAAA,EAAM;gBACN7D,KAAA,EAAOhB,CAAA,CAAE;cACX;cACA8E,QAAA,EAAUA,CAAA,KAAM5C,gBAAA,CAAiB,CAACD,aAAA;cAClC8C,IAAA,EAAK;;cAGRnE,aAAA,iBAAiBgD,IAAA,CAACvE,cAAA;YAAeuB,aAAA,EAAeA,aAAA;YAAekE,QAAA,EAAUjD;2BAC1E+B,IAAA,CAAChF,WAAA;YACCgG,KAAA,EAAO;cACLC,IAAA,EAAM;cACNV,KAAA,EAAO;gBACLa,IAAA,EAAM;cACR;cACAhE,KAAA,EAAOhB,CAAA,CAAE;cACTiF,GAAA,EAAK;cACLC,GAAA,EAAK;YACP;YACAJ,QAAA,EAAW7D,KAAA,IAAUc,QAAA,CAASd,KAAA,EAAOe,QAAA;YACrC+C,IAAA,EAAK;;;;qBAKbxB,KAAA,CAAC;MAAIC,SAAA,EAAW,GAAGjE,SAAA,mBAA4B;8BAC7CqE,IAAA,CAAC;QAAIJ,SAAA,EAAW,GAAGjE,SAAA,sCAA+C;kBAChE,aAAAqE,IAAA,CAAC;UACC,cAAW;UACXJ,SAAA,EAAW,GAAGjE,SAAA,4BAAqC;UACnD4F,OAAA,EAASA,CAAA,KAAM/C,aAAA,CAAc,CAACD,UAAA;UAC9BiD,IAAA,EAAK;oBAEL,aAAAxB,IAAA,CAACjF,oBAAA;YAAqB0G,WAAA,EAAa,CAAClD;;;uBAGxCyB,IAAA,CAAC;QAAIJ,SAAA,EAAW,GAAGjE,SAAA,WAAoB;kBACrC,aAAAqE,IAAA,CAACtE,UAAA;UAAWgG,MAAA,EAAQ/D;;;;;AAK9B","ignoreList":[]}