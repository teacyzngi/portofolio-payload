{"version":3,"sources":["../../src/hooks/afterRead.ts"],"sourcesContent":["import type { CollectionConfig, FieldHook, ImageSize } from 'payload'\n\nimport type { GeneratedAdapter, GenerateFileURL } from '../types.js'\n\ninterface Args {\n  adapter: GeneratedAdapter\n  collection: CollectionConfig\n  disablePayloadAccessControl?: boolean\n  generateFileURL?: GenerateFileURL\n  size?: ImageSize\n}\n\nexport const getAfterReadHook =\n  ({ adapter, collection, disablePayloadAccessControl, generateFileURL, size }: Args): FieldHook =>\n  async ({ data, value }) => {\n    const filename = size ? data?.sizes?.[size.name]?.filename : data?.filename\n    const prefix = data?.prefix\n    let url = value\n\n    if (disablePayloadAccessControl && filename) {\n      url = await adapter.generateURL?.({\n        collection,\n        data,\n        filename,\n        prefix,\n      })\n    }\n\n    if (generateFileURL) {\n      url = await generateFileURL({\n        collection,\n        filename,\n        prefix,\n        size,\n      })\n    }\n\n    return url\n  }\n"],"names":["getAfterReadHook","adapter","collection","disablePayloadAccessControl","generateFileURL","size","data","value","filename","sizes","name","prefix","url","generateURL"],"mappings":"AAYA,OAAO,MAAMA,mBACX,CAAC,EAAEC,OAAO,EAAEC,UAAU,EAAEC,2BAA2B,EAAEC,eAAe,EAAEC,IAAI,EAAQ,GAClF,OAAO,EAAEC,IAAI,EAAEC,KAAK,EAAE;QACpB,MAAMC,WAAWH,OAAOC,MAAMG,OAAO,CAACJ,KAAKK,IAAI,CAAC,EAAEF,WAAWF,MAAME;QACnE,MAAMG,SAASL,MAAMK;QACrB,IAAIC,MAAML;QAEV,IAAIJ,+BAA+BK,UAAU;YAC3CI,MAAM,MAAMX,QAAQY,WAAW,GAAG;gBAChCX;gBACAI;gBACAE;gBACAG;YACF;QACF;QAEA,IAAIP,iBAAiB;YACnBQ,MAAM,MAAMR,gBAAgB;gBAC1BF;gBACAM;gBACAG;gBACAN;YACF;QACF;QAEA,OAAOO;IACT,EAAC"}