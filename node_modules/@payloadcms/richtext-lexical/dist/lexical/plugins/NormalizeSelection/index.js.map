{"version":3,"file":"index.js","names":["useLexicalComposerContext","$getSelection","$isRangeSelection","RootNode","useEffect","NormalizeSelectionPlugin","editor","registerNodeTransform","root","selection","anchorNode","anchor","getNode","focusNode","focus","isAttached","selectEnd","console","warn"],"sources":["../../../../src/lexical/plugins/NormalizeSelection/index.tsx"],"sourcesContent":["import { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext'\nimport { $getSelection, $isRangeSelection, RootNode } from 'lexical'\nimport { useEffect } from 'react'\n\n/**\n * By default, Lexical throws an error if the selection ends in deleted nodes.\n * This is very aggressive considering there are reasons why this can happen\n * outside of Payload's control (custom features or conflicting features, for example).\n * In the case of selections on nonexistent nodes, this plugin moves the selection to\n * the end of the editor and displays a warning instead of an error.\n */\nexport function NormalizeSelectionPlugin() {\n  const [editor] = useLexicalComposerContext()\n\n  useEffect(() => {\n    return editor.registerNodeTransform(RootNode, (root) => {\n      const selection = $getSelection()\n      if ($isRangeSelection(selection)) {\n        const anchorNode = selection.anchor.getNode()\n        const focusNode = selection.focus.getNode()\n        if (!anchorNode.isAttached() || !focusNode.isAttached()) {\n          root.selectEnd()\n          // eslint-disable-next-line no-console\n          console.warn(\n            'updateEditor: selection has been moved to the end of the editor because the previously selected nodes have been removed and ' +\n              \"selection wasn't moved to another node. Ensure selection changes after removing/replacing a selected node.\",\n          )\n        }\n      }\n      return false\n    })\n  }, [editor])\n\n  return null\n}\n"],"mappings":"AAAA,SAASA,yBAAyB,QAAQ;AAC1C,SAASC,aAAa,EAAEC,iBAAiB,EAAEC,QAAQ,QAAQ;AAC3D,SAASC,SAAS,QAAQ;AAE1B;;;;;;;AAOA,OAAO,SAASC,yBAAA;EACd,MAAM,CAACC,MAAA,CAAO,GAAGN,yBAAA;EAEjBI,SAAA,CAAU;IACR,OAAOE,MAAA,CAAOC,qBAAqB,CAACJ,QAAA,EAAWK,IAAA;MAC7C,MAAMC,SAAA,GAAYR,aAAA;MAClB,IAAIC,iBAAA,CAAkBO,SAAA,GAAY;QAChC,MAAMC,UAAA,GAAaD,SAAA,CAAUE,MAAM,CAACC,OAAO;QAC3C,MAAMC,SAAA,GAAYJ,SAAA,CAAUK,KAAK,CAACF,OAAO;QACzC,IAAI,CAACF,UAAA,CAAWK,UAAU,MAAM,CAACF,SAAA,CAAUE,UAAU,IAAI;UACvDP,IAAA,CAAKQ,SAAS;UACd;UACAC,OAAA,CAAQC,IAAI,CACV,iIACE;QAEN;MACF;MACA,OAAO;IACT;EACF,GAAG,CAACZ,MAAA,CAAO;EAEX,OAAO;AACT","ignoreList":[]}