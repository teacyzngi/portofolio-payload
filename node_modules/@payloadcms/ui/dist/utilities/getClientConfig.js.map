{"version":3,"file":"getClientConfig.js","names":["createClientConfig","createUnauthenticatedClientConfig","cache","cachedClientConfigs","global","_payload_clientConfigs","getClientConfig","config","i18n","importMap","user","currentLanguage","language","_payload_doNotCacheClientConfig","clientConfig","cachedClientConfig"],"sources":["../../src/utilities/getClientConfig.ts"],"sourcesContent":["import type { SupportedLanguages } from '@payloadcms/translations'\nimport type { ClientConfig, CreateClientConfigArgs } from 'payload'\n\nimport { createClientConfig, createUnauthenticatedClientConfig } from 'payload'\nimport { cache } from 'react'\n\ntype CachedClientConfigs = Record<keyof SupportedLanguages, ClientConfig>\n\nlet cachedClientConfigs = global._payload_clientConfigs as CachedClientConfigs\n\nif (!cachedClientConfigs) {\n  cachedClientConfigs = global._payload_clientConfigs = {} as CachedClientConfigs\n}\n\nexport const getClientConfig = cache(\n  ({ config, i18n, importMap, user }: CreateClientConfigArgs): ClientConfig => {\n    const currentLanguage = i18n.language\n\n    if (cachedClientConfigs[currentLanguage] && !global._payload_doNotCacheClientConfig) {\n      if (!user) {\n        return createUnauthenticatedClientConfig({\n          clientConfig: cachedClientConfigs[currentLanguage],\n        }) as unknown as ClientConfig\n      }\n\n      return cachedClientConfigs[currentLanguage]\n    }\n\n    const cachedClientConfig = createClientConfig({\n      config,\n      i18n,\n      importMap,\n      user,\n    })\n\n    cachedClientConfigs[currentLanguage] = cachedClientConfig\n    global._payload_clientConfigs = cachedClientConfigs\n    global._payload_doNotCacheClientConfig = false\n\n    if (!user) {\n      return createUnauthenticatedClientConfig({\n        clientConfig: cachedClientConfig,\n      }) as unknown as ClientConfig\n    }\n\n    return cachedClientConfig\n  },\n)\n"],"mappings":"AAGA,SAASA,kBAAkB,EAAEC,iCAAiC,QAAQ;AACtE,SAASC,KAAK,QAAQ;AAItB,IAAIC,mBAAA,GAAsBC,MAAA,CAAOC,sBAAsB;AAEvD,IAAI,CAACF,mBAAA,EAAqB;EACxBA,mBAAA,GAAsBC,MAAA,CAAOC,sBAAsB,GAAG,CAAC;AACzD;AAEA,OAAO,MAAMC,eAAA,GAAkBJ,KAAA,CAC7B,CAAC;EAAEK,MAAM;EAAEC,IAAI;EAAEC,SAAS;EAAEC;AAAI,CAA0B;EACxD,MAAMC,eAAA,GAAkBH,IAAA,CAAKI,QAAQ;EAErC,IAAIT,mBAAmB,CAACQ,eAAA,CAAgB,IAAI,CAACP,MAAA,CAAOS,+BAA+B,EAAE;IACnF,IAAI,CAACH,IAAA,EAAM;MACT,OAAOT,iCAAA,CAAkC;QACvCa,YAAA,EAAcX,mBAAmB,CAACQ,eAAA;MACpC;IACF;IAEA,OAAOR,mBAAmB,CAACQ,eAAA,CAAgB;EAC7C;EAEA,MAAMI,kBAAA,GAAqBf,kBAAA,CAAmB;IAC5CO,MAAA;IACAC,IAAA;IACAC,SAAA;IACAC;EACF;EAEAP,mBAAmB,CAACQ,eAAA,CAAgB,GAAGI,kBAAA;EACvCX,MAAA,CAAOC,sBAAsB,GAAGF,mBAAA;EAChCC,MAAA,CAAOS,+BAA+B,GAAG;EAEzC,IAAI,CAACH,IAAA,EAAM;IACT,OAAOT,iCAAA,CAAkC;MACvCa,YAAA,EAAcC;IAChB;EACF;EAEA,OAAOA,kBAAA;AACT","ignoreList":[]}