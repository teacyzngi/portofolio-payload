{"version":3,"file":"sanitizeQuery.js","names":["sanitizeQuery","toSanitize","sanitized","Object","entries","forEach","key","value","Array","isArray","length","keys","parsed","parseInt","Number","isNaN","undefined"],"sources":["../../../src/providers/ListQuery/sanitizeQuery.ts"],"sourcesContent":["import type { ListQuery, Where } from 'payload'\n\n/**\n * Sanitize empty strings from the query, e.g. `?preset=`\n * This is how we determine whether to clear user preferences for certain params\n * Once cleared, they are no longer needed in the URL\n */\nexport const sanitizeQuery = (toSanitize: ListQuery): ListQuery => {\n  const sanitized = { ...toSanitize }\n\n  Object.entries(sanitized).forEach(([key, value]) => {\n    if (\n      key === 'columns' &&\n      (value === '[]' || (Array.isArray(sanitized[key]) && sanitized[key].length === 0))\n    ) {\n      delete sanitized[key]\n    }\n\n    if (key === 'where' && typeof value === 'object' && !Object.keys(value as Where).length) {\n      delete sanitized[key]\n    }\n\n    if ((key === 'limit' || key === 'page') && typeof value === 'string') {\n      const parsed = parseInt(value, 10)\n      sanitized[key] = Number.isNaN(parsed) ? undefined : parsed\n    }\n\n    if (key === 'page' && value === 0) {\n      delete sanitized[key]\n    }\n\n    if (value === '') {\n      delete sanitized[key]\n    }\n  })\n\n  return sanitized\n}\n"],"mappings":"AAEA;;;;GAKA,OAAO,MAAMA,aAAA,GAAiBC,UAAA;EAC5B,MAAMC,SAAA,GAAY;IAAE,GAAGD;EAAW;EAElCE,MAAA,CAAOC,OAAO,CAACF,SAAA,EAAWG,OAAO,CAAC,CAAC,CAACC,GAAA,EAAKC,KAAA,CAAM;IAC7C,IACED,GAAA,KAAQ,cACPC,KAAA,KAAU,QAASC,KAAA,CAAMC,OAAO,CAACP,SAAS,CAACI,GAAA,CAAI,KAAKJ,SAAS,CAACI,GAAA,CAAI,CAACI,MAAM,KAAK,CAAC,GAChF;MACA,OAAOR,SAAS,CAACI,GAAA,CAAI;IACvB;IAEA,IAAIA,GAAA,KAAQ,WAAW,OAAOC,KAAA,KAAU,YAAY,CAACJ,MAAA,CAAOQ,IAAI,CAACJ,KAAA,EAAgBG,MAAM,EAAE;MACvF,OAAOR,SAAS,CAACI,GAAA,CAAI;IACvB;IAEA,IAAI,CAACA,GAAA,KAAQ,WAAWA,GAAA,KAAQ,MAAK,KAAM,OAAOC,KAAA,KAAU,UAAU;MACpE,MAAMK,MAAA,GAASC,QAAA,CAASN,KAAA,EAAO;MAC/BL,SAAS,CAACI,GAAA,CAAI,GAAGQ,MAAA,CAAOC,KAAK,CAACH,MAAA,IAAUI,SAAA,GAAYJ,MAAA;IACtD;IAEA,IAAIN,GAAA,KAAQ,UAAUC,KAAA,KAAU,GAAG;MACjC,OAAOL,SAAS,CAACI,GAAA,CAAI;IACvB;IAEA,IAAIC,KAAA,KAAU,IAAI;MAChB,OAAOL,SAAS,CAACI,GAAA,CAAI;IACvB;EACF;EAEA,OAAOJ,SAAA;AACT","ignoreList":[]}