{"version":3,"file":"ListCreateNewDocInFolderButton.js","names":["c","_c","useModal","getTranslation","React","useConfig","useFolder","useTranslation","Button","DocumentDrawer","useDocumentDrawer","Popup","PopupList","baseClass","ListCreateNewDocInFolderButton","t0","$","buttonLabel","collectionSlugs","folderAssignedCollections","onCreateSuccess","slugPrefix","newDocInFolderDrawerSlug","i18n","closeModal","openModal","config","folderCollectionConfig","folderCollectionSlug","folderFieldName","folderID","t1","collectionSlug","FolderDocumentDrawer","t2","closeDrawer","closeFolderDrawer","openDrawer","openFolderDrawer","createCollectionSlug","setCreateCollectionSlug","useState","t3","reduce","acc","collectionConfig","collections","find","t4","slug","push","enabledCollections","length","_jsxs","Fragment","children","_jsx","buttonStyle","className","el","onClick","size","button","icon","ButtonGroup","map","collection","index","labels","singular","drawerSlug","initialData","onSave","t5","doc","redirectAfterCreate","includes","folderType","result"],"sources":["../../../../src/elements/ListHeader/TitleActions/ListCreateNewDocInFolderButton.tsx"],"sourcesContent":["'use client'\n\nimport type { ClientCollectionConfig, CollectionSlug } from 'payload'\n\nimport { useModal } from '@faceless-ui/modal'\nimport { getTranslation } from '@payloadcms/translations'\nimport React from 'react'\n\nimport { useConfig } from '../../../providers/Config/index.js'\nimport { useFolder } from '../../../providers/Folders/index.js'\nimport { useTranslation } from '../../../providers/Translation/index.js'\nimport { Button } from '../../Button/index.js'\nimport { DocumentDrawer, useDocumentDrawer } from '../../DocumentDrawer/index.js'\nimport { Popup, PopupList } from '../../Popup/index.js'\n\nconst baseClass = 'create-new-doc-in-folder'\n\nexport function ListCreateNewDocInFolderButton({\n  buttonLabel,\n  collectionSlugs,\n  folderAssignedCollections,\n  onCreateSuccess,\n  slugPrefix,\n}: {\n  buttonLabel: string\n  collectionSlugs: CollectionSlug[]\n  folderAssignedCollections: CollectionSlug[]\n  onCreateSuccess: (args: {\n    collectionSlug: CollectionSlug\n    doc: Record<string, unknown>\n  }) => Promise<void> | void\n  slugPrefix: string\n}) {\n  const newDocInFolderDrawerSlug = `${slugPrefix}-new-doc-in-folder-drawer`\n  const { i18n } = useTranslation()\n  const { closeModal, openModal } = useModal()\n  const { config } = useConfig()\n  const { folderCollectionConfig, folderCollectionSlug, folderFieldName, folderID } = useFolder()\n  const [FolderDocumentDrawer, , { closeDrawer: closeFolderDrawer, openDrawer: openFolderDrawer }] =\n    useDocumentDrawer({\n      collectionSlug: folderCollectionSlug,\n    })\n  const [createCollectionSlug, setCreateCollectionSlug] = React.useState<string | undefined>()\n  const [enabledCollections] = React.useState<ClientCollectionConfig[]>(() =>\n    collectionSlugs.reduce((acc, collectionSlug) => {\n      const collectionConfig = config.collections.find(({ slug }) => slug === collectionSlug)\n      if (collectionConfig) {\n        acc.push(collectionConfig)\n      }\n      return acc\n    }, []),\n  )\n\n  if (enabledCollections.length === 0) {\n    return null\n  }\n\n  return (\n    <React.Fragment>\n      {enabledCollections.length === 1 ? (\n        // If there is only 1 option, do not render a popup\n        <Button\n          buttonStyle=\"pill\"\n          className={`${baseClass}__button`}\n          el=\"div\"\n          onClick={() => {\n            if (enabledCollections[0].slug === folderCollectionConfig.slug) {\n              openFolderDrawer()\n            } else {\n              setCreateCollectionSlug(enabledCollections[0].slug)\n              openModal(newDocInFolderDrawerSlug)\n            }\n          }}\n          size=\"small\"\n        >\n          {buttonLabel}\n        </Button>\n      ) : (\n        <Popup\n          button={\n            <Button\n              buttonStyle=\"pill\"\n              className={`${baseClass}__popup-button`}\n              el=\"div\"\n              icon=\"chevron\"\n              size=\"small\"\n            >\n              {buttonLabel}\n            </Button>\n          }\n          buttonType=\"default\"\n          className={`${baseClass}__action-popup`}\n        >\n          <PopupList.ButtonGroup>\n            {enabledCollections.map((collection, index) => {\n              return (\n                <PopupList.Button\n                  key={index}\n                  onClick={() => {\n                    if (collection.slug === folderCollectionConfig.slug) {\n                      openFolderDrawer()\n                    } else {\n                      setCreateCollectionSlug(collection.slug)\n                      openModal(newDocInFolderDrawerSlug)\n                    }\n                  }}\n                >\n                  {getTranslation(collection.labels.singular, i18n)}\n                </PopupList.Button>\n              )\n            })}\n          </PopupList.ButtonGroup>\n        </Popup>\n      )}\n\n      {createCollectionSlug && (\n        <DocumentDrawer\n          collectionSlug={createCollectionSlug}\n          drawerSlug={newDocInFolderDrawerSlug}\n          initialData={{\n            [folderFieldName]: folderID,\n          }}\n          onSave={async ({ doc }) => {\n            await onCreateSuccess({\n              collectionSlug: createCollectionSlug,\n              doc,\n            })\n            closeModal(newDocInFolderDrawerSlug)\n          }}\n          redirectAfterCreate={false}\n        />\n      )}\n\n      {collectionSlugs.includes(folderCollectionConfig.slug) && (\n        <FolderDocumentDrawer\n          initialData={{\n            [folderFieldName]: folderID,\n            folderType: createCollectionSlug\n              ? folderAssignedCollections || [createCollectionSlug]\n              : folderAssignedCollections,\n          }}\n          onSave={async (result) => {\n            await onCreateSuccess({\n              collectionSlug: folderCollectionConfig.slug,\n              doc: result.doc,\n            })\n            closeFolderDrawer()\n          }}\n          redirectAfterCreate={false}\n        />\n      )}\n    </React.Fragment>\n  )\n}\n"],"mappings":"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","ignoreList":[]}