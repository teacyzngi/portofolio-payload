{"version":3,"file":"index.js","names":["c","_c","React","useCallback","useForm","useFormModified","useAuth","useTranslation","ConfirmationModal","useModal","usePreventLeave","modalSlug","LeaveWithoutSaving","t0","$","onConfirm","onPrevent","closeModal","openModal","modified","isValid","user","hasAccepted","setHasAccepted","useState","t","prevent","Boolean","t1","activeHref","document","activeElement","href","handlePrevent","t2","handleAccept","t3","onAccept","t4","onCancel","t5","t6","err","console","error","handleConfirm","_jsx","body","cancelLabel","confirmLabel","heading"],"sources":["../../../src/elements/LeaveWithoutSaving/index.tsx"],"sourcesContent":["'use client'\nimport React, { useCallback } from 'react'\n\nimport type { OnCancel } from '../ConfirmationModal/index.js'\n\nimport { useForm, useFormModified } from '../../forms/Form/index.js'\nimport { useAuth } from '../../providers/Auth/index.js'\nimport { useTranslation } from '../../providers/Translation/index.js'\nimport { ConfirmationModal } from '../ConfirmationModal/index.js'\nimport { useModal } from '../Modal/index.js'\nimport { usePreventLeave } from './usePreventLeave.js'\n\nconst modalSlug = 'leave-without-saving'\n\ntype LeaveWithoutSavingProps = {\n  onConfirm?: () => Promise<void> | void\n  onPrevent?: (nextHref: null | string) => void\n}\n\nexport const LeaveWithoutSaving: React.FC<LeaveWithoutSavingProps> = ({ onConfirm, onPrevent }) => {\n  const { closeModal, openModal } = useModal()\n  const modified = useFormModified()\n  const { isValid } = useForm()\n  const { user } = useAuth()\n  const [hasAccepted, setHasAccepted] = React.useState(false)\n  const { t } = useTranslation()\n\n  const prevent = Boolean((modified || !isValid) && user)\n\n  const handlePrevent = useCallback(() => {\n    const activeHref = (document.activeElement as HTMLAnchorElement)?.href || null\n    if (onPrevent) {\n      onPrevent(activeHref)\n    }\n    openModal(modalSlug)\n  }, [openModal, onPrevent])\n\n  const handleAccept = useCallback(() => {\n    closeModal(modalSlug)\n  }, [closeModal])\n\n  usePreventLeave({ hasAccepted, onAccept: handleAccept, onPrevent: handlePrevent, prevent })\n\n  const onCancel: OnCancel = useCallback(() => {\n    closeModal(modalSlug)\n  }, [closeModal])\n\n  const handleConfirm = useCallback(async () => {\n    if (onConfirm) {\n      try {\n        await onConfirm()\n      } catch (err) {\n        console.error('Error in LeaveWithoutSaving onConfirm:', err)\n      }\n    }\n    setHasAccepted(true)\n  }, [onConfirm])\n\n  return (\n    <ConfirmationModal\n      body={t('general:changesNotSaved')}\n      cancelLabel={t('general:stayOnThisPage')}\n      confirmLabel={t('general:leaveAnyway')}\n      heading={t('general:leaveWithoutSaving')}\n      modalSlug={modalSlug}\n      onCancel={onCancel}\n      onConfirm={handleConfirm}\n    />\n  )\n}\n"],"mappings":"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","ignoreList":[]}