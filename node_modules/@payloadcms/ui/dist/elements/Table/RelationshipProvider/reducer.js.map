{"version":3,"file":"reducer.js","names":["reducer","state","action","type","newState","relationTo","unreturnedIDs","idsToLoad","Array","isArray","docs","forEach","doc","splice","indexOf","id","value"],"sources":["../../../../src/elements/Table/RelationshipProvider/reducer.ts"],"sourcesContent":["import type { TypeWithID } from 'payload'\n\nimport type { Documents } from './index.js'\n\ntype RequestDocuments = {\n  docs: { relationTo: string; value: number | string }[]\n  type: 'REQUEST'\n}\n\ntype AddLoadedDocuments = {\n  docs: TypeWithID[]\n  idsToLoad: (number | string)[]\n  relationTo: string\n  type: 'ADD_LOADED'\n}\n\ntype Action = AddLoadedDocuments | RequestDocuments\n\nexport function reducer(state: Documents, action: Action): Documents {\n  switch (action.type) {\n    case 'ADD_LOADED': {\n      const newState = { ...state }\n      if (typeof newState[action.relationTo] !== 'object') {\n        newState[action.relationTo] = {}\n      }\n      const unreturnedIDs = [...action.idsToLoad]\n\n      if (Array.isArray(action.docs)) {\n        action.docs.forEach((doc) => {\n          unreturnedIDs.splice(unreturnedIDs.indexOf(doc.id), 1)\n          newState[action.relationTo][doc.id] = doc\n        })\n      }\n\n      unreturnedIDs.forEach((id) => {\n        newState[action.relationTo][id] = false\n      })\n\n      return newState\n    }\n\n    case 'REQUEST': {\n      const newState = { ...state }\n\n      action.docs.forEach(({ relationTo, value }) => {\n        if (typeof newState[relationTo] !== 'object') {\n          newState[relationTo] = {}\n        }\n        newState[relationTo][value] = null\n      })\n\n      return newState\n    }\n\n    default: {\n      return state\n    }\n  }\n}\n"],"mappings":"AAkBA,OAAO,SAASA,QAAQC,KAAgB,EAAEC,MAAc;EACtD,QAAQA,MAAA,CAAOC,IAAI;IACjB,KAAK;MAAc;QACjB,MAAMC,QAAA,GAAW;UAAE,GAAGH;QAAM;QAC5B,IAAI,OAAOG,QAAQ,CAACF,MAAA,CAAOG,UAAU,CAAC,KAAK,UAAU;UACnDD,QAAQ,CAACF,MAAA,CAAOG,UAAU,CAAC,GAAG,CAAC;QACjC;QACA,MAAMC,aAAA,GAAgB,C,GAAIJ,MAAA,CAAOK,SAAS,CAAC;QAE3C,IAAIC,KAAA,CAAMC,OAAO,CAACP,MAAA,CAAOQ,IAAI,GAAG;UAC9BR,MAAA,CAAOQ,IAAI,CAACC,OAAO,CAAEC,GAAA;YACnBN,aAAA,CAAcO,MAAM,CAACP,aAAA,CAAcQ,OAAO,CAACF,GAAA,CAAIG,EAAE,GAAG;YACpDX,QAAQ,CAACF,MAAA,CAAOG,UAAU,CAAC,CAACO,GAAA,CAAIG,EAAE,CAAC,GAAGH,GAAA;UACxC;QACF;QAEAN,aAAA,CAAcK,OAAO,CAAEI,EAAA;UACrBX,QAAQ,CAACF,MAAA,CAAOG,UAAU,CAAC,CAACU,EAAA,CAAG,GAAG;QACpC;QAEA,OAAOX,QAAA;MACT;IAEA,KAAK;MAAW;QACd,MAAMA,QAAA,GAAW;UAAE,GAAGH;QAAM;QAE5BC,MAAA,CAAOQ,IAAI,CAACC,OAAO,CAAC,CAAC;UAAEN,UAAU;UAAEW;QAAK,CAAE;UACxC,IAAI,OAAOZ,QAAQ,CAACC,UAAA,CAAW,KAAK,UAAU;YAC5CD,QAAQ,CAACC,UAAA,CAAW,GAAG,CAAC;UAC1B;UACAD,QAAQ,CAACC,UAAA,CAAW,CAACW,KAAA,CAAM,GAAG;QAChC;QAEA,OAAOZ,QAAA;MACT;IAEA;MAAS;QACP,OAAOH,KAAA;MACT;EACF;AACF","ignoreList":[]}