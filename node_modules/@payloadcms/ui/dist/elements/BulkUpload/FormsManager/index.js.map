{"version":3,"file":"index.js","names":["useModal","qs","React","toast","fieldReducer","useEffectEvent","useConfig","useLocale","useServerFunctions","useTranslation","useUploadHandlers","hasSavePermission","getHasSavePermission","LoadingOverlay","useLoadingOverlay","useBulkUpload","createFormData","formsManagementReducer","Context","createContext","activeIndex","addFiles","Promise","resolve","bulkUpdateForm","collectionSlug","docPermissions","undefined","documentSlots","forms","getFormDataRef","current","hasPublishPermission","hasSubmitted","isInitializing","removeFile","saveAllDocs","setActiveIndex","setFormTotalErrorCount","totalErrorCount","updateUploadEdits","initialState","FormsManagerProvider","children","config","routes","api","serverURL","code","i18n","t","getDocumentSlots","getFormState","getUploadHandler","setDocumentSlots","useState","setHasSubmitted","setDocPermissions","setHasSavePermission","setHasPublishPermission","hasInitializedState","setHasInitializedState","hasInitializedDocPermissions","setHasInitializedDocPermissions","setIsInitializing","state","dispatch","useReducer","formsRef","useRef","toggleLoadingOverlay","closeModal","drawerSlug","initialFiles","initialForms","onSuccess","setInitialFiles","setInitialForms","setSuccessfullyUploaded","isUploading","setIsUploading","loadingText","setLoadingText","hasInitializedWithFiles","initialStateRef","actionURL","initializeSharedDocPermissions","useCallback","params","locale","docAccessURL","res","fetch","stringify","credentials","headers","language","method","json","publishedAccessJSON","body","JSON","_status","then","isEditing","update","initializeSharedFormState","abortController","signal","abort","formStateWithoutFiles","docPreferences","fields","operation","renderAllFields","schemaPath","skipValidation","_err","index","currentFormsData","type","map","form","i","errorCount","formID","formState","uploadEdits","files","length","isLoading","key","Array","from","file","addFilesEffectEvent","addInitialForms","count","overrides","currentForms","newDocs","total","actionURLWithParams","addQueryPrefix","req","status","doc","push","fieldErrors","nonFieldErrors","errors","reduce","fieldErrs","nonFieldErrs","err","newFieldErrs","newNonFieldErrs","message","isArray","data","forEach","dataError","path","error","_","remainingForms","successCount","Math","max","success","acc","updatedFields","afterStateUpdate","Object","entries","value","newFormErrorCount","values","valid","resetUploadEdits","useEffect","_jsxs","_jsx","animationDuration","overlayType","show","useFormsManager","use"],"sources":["../../../../src/elements/BulkUpload/FormsManager/index.tsx"],"sourcesContent":["'use client'\n\nimport type {\n  CollectionSlug,\n  Data,\n  DocumentSlots,\n  FormState,\n  JsonObject,\n  SanitizedDocumentPermissions,\n  UploadEdits,\n} from 'payload'\n\nimport { useModal } from '@faceless-ui/modal'\nimport * as qs from 'qs-esm'\nimport React from 'react'\nimport { toast } from 'sonner'\n\nimport type { State } from './reducer.js'\n\nimport { fieldReducer } from '../../../forms/Form/fieldReducer.js'\nimport { useEffectEvent } from '../../../hooks/useEffectEvent.js'\nimport { useConfig } from '../../../providers/Config/index.js'\nimport { useLocale } from '../../../providers/Locale/index.js'\nimport { useServerFunctions } from '../../../providers/ServerFunctions/index.js'\nimport { useTranslation } from '../../../providers/Translation/index.js'\nimport { useUploadHandlers } from '../../../providers/UploadHandlers/index.js'\nimport { hasSavePermission as getHasSavePermission } from '../../../utilities/hasSavePermission.js'\nimport { LoadingOverlay } from '../../Loading/index.js'\nimport { useLoadingOverlay } from '../../LoadingOverlay/index.js'\nimport { useBulkUpload } from '../index.js'\nimport { createFormData } from './createFormData.js'\nimport { formsManagementReducer } from './reducer.js'\n\ntype FormsManagerContext = {\n  readonly activeIndex: State['activeIndex']\n  readonly addFiles: (filelist: FileList) => Promise<void>\n  readonly bulkUpdateForm: (\n    updatedFields: Record<string, unknown>,\n    afterStateUpdate?: () => void,\n  ) => Promise<void>\n  readonly collectionSlug: string\n  readonly docPermissions?: SanitizedDocumentPermissions\n  readonly documentSlots: DocumentSlots\n  readonly forms: State['forms']\n  getFormDataRef: React.RefObject<() => Data>\n  readonly hasPublishPermission: boolean\n  readonly hasSavePermission: boolean\n  readonly hasSubmitted: boolean\n  readonly isInitializing: boolean\n  readonly removeFile: (index: number) => void\n  readonly resetUploadEdits?: () => void\n  readonly saveAllDocs: ({ overrides }?: { overrides?: Record<string, unknown> }) => Promise<void>\n  readonly setActiveIndex: (index: number) => void\n  readonly setFormTotalErrorCount: ({\n    errorCount,\n    index,\n  }: {\n    errorCount: number\n    index: number\n  }) => void\n  readonly totalErrorCount?: number\n  readonly updateUploadEdits: (args: UploadEdits) => void\n}\n\nconst Context = React.createContext<FormsManagerContext>({\n  activeIndex: 0,\n  addFiles: () => Promise.resolve(),\n  bulkUpdateForm: () => null,\n  collectionSlug: '',\n  docPermissions: undefined,\n  documentSlots: {},\n  forms: [],\n  getFormDataRef: { current: () => ({}) },\n  hasPublishPermission: false,\n  hasSavePermission: false,\n  hasSubmitted: false,\n  isInitializing: false,\n  removeFile: () => {},\n  saveAllDocs: () => Promise.resolve(),\n  setActiveIndex: () => 0,\n  setFormTotalErrorCount: () => {},\n  totalErrorCount: 0,\n  updateUploadEdits: () => {},\n})\n\nconst initialState: State = {\n  activeIndex: 0,\n  forms: [],\n  totalErrorCount: 0,\n}\n\nexport type InitialForms = Array<{\n  file: File\n  formID?: string\n  initialState?: FormState | null\n}>\n\ntype FormsManagerProps = {\n  readonly children: React.ReactNode\n}\n\nexport function FormsManagerProvider({ children }: FormsManagerProps) {\n  const { config } = useConfig()\n  const {\n    routes: { api },\n    serverURL,\n  } = config\n  const { code } = useLocale()\n  const { i18n, t } = useTranslation()\n\n  const { getDocumentSlots, getFormState } = useServerFunctions()\n  const { getUploadHandler } = useUploadHandlers()\n\n  const [documentSlots, setDocumentSlots] = React.useState<DocumentSlots>({})\n  const [hasSubmitted, setHasSubmitted] = React.useState(false)\n  const [docPermissions, setDocPermissions] = React.useState<SanitizedDocumentPermissions>()\n  const [hasSavePermission, setHasSavePermission] = React.useState(false)\n  const [hasPublishPermission, setHasPublishPermission] = React.useState(false)\n  const [hasInitializedState, setHasInitializedState] = React.useState(false)\n  const [hasInitializedDocPermissions, setHasInitializedDocPermissions] = React.useState(false)\n  const [isInitializing, setIsInitializing] = React.useState(false)\n  const [state, dispatch] = React.useReducer(formsManagementReducer, initialState)\n  const { activeIndex, forms, totalErrorCount } = state\n\n  const formsRef = React.useRef(forms)\n  formsRef.current = forms\n\n  const { toggleLoadingOverlay } = useLoadingOverlay()\n  const { closeModal } = useModal()\n  const {\n    collectionSlug,\n    drawerSlug,\n    initialFiles,\n    initialForms,\n    onSuccess,\n    setInitialFiles,\n    setInitialForms,\n    setSuccessfullyUploaded,\n  } = useBulkUpload()\n\n  const [isUploading, setIsUploading] = React.useState(false)\n  const [loadingText, setLoadingText] = React.useState('')\n\n  const hasInitializedWithFiles = React.useRef(false)\n  const initialStateRef = React.useRef<FormState>(null)\n  const getFormDataRef = React.useRef<() => Data>(() => ({}))\n\n  const actionURL = `${serverURL}${api}/${collectionSlug}`\n\n  const initializeSharedDocPermissions = React.useCallback(async () => {\n    const params = {\n      locale: code || undefined,\n    }\n\n    const docAccessURL = `/${collectionSlug}/access`\n    const res = await fetch(`${serverURL}${api}${docAccessURL}?${qs.stringify(params)}`, {\n      credentials: 'include',\n      headers: {\n        'Accept-Language': i18n.language,\n        'Content-Type': 'application/json',\n      },\n      method: 'post',\n    })\n\n    const json: SanitizedDocumentPermissions = await res.json()\n    const publishedAccessJSON = await fetch(\n      `${serverURL}${api}${docAccessURL}?${qs.stringify(params)}`,\n      {\n        body: JSON.stringify({\n          _status: 'published',\n        }),\n        credentials: 'include',\n        headers: {\n          'Accept-Language': i18n.language,\n          'Content-Type': 'application/json',\n        },\n        method: 'POST',\n      },\n    ).then((res) => res.json())\n\n    setDocPermissions(json)\n\n    setHasSavePermission(\n      getHasSavePermission({\n        collectionSlug,\n        docPermissions: json,\n        isEditing: false,\n      }),\n    )\n\n    setHasPublishPermission(publishedAccessJSON?.update)\n    setHasInitializedDocPermissions(true)\n  }, [api, code, collectionSlug, i18n.language, serverURL])\n\n  const initializeSharedFormState = React.useCallback(\n    async (abortController?: AbortController) => {\n      if (abortController?.signal) {\n        abortController.abort('aborting previous fetch for initial form state without files')\n      }\n\n      // FETCH AND SET THE DOCUMENT SLOTS HERE!\n      const documentSlots = await getDocumentSlots({ collectionSlug })\n      setDocumentSlots(documentSlots)\n\n      try {\n        const { state: formStateWithoutFiles } = await getFormState({\n          collectionSlug,\n          docPermissions,\n          docPreferences: { fields: {} },\n          locale: code,\n          operation: 'create',\n          renderAllFields: true,\n          schemaPath: collectionSlug,\n          skipValidation: true,\n        })\n        initialStateRef.current = formStateWithoutFiles\n        setHasInitializedState(true)\n      } catch (_err) {\n        // swallow error\n      }\n    },\n    [getDocumentSlots, collectionSlug, getFormState, docPermissions, code],\n  )\n\n  const setActiveIndex: FormsManagerContext['setActiveIndex'] = React.useCallback(\n    (index: number) => {\n      const currentFormsData = getFormDataRef.current()\n      dispatch({\n        type: 'REPLACE',\n        state: {\n          activeIndex: index,\n          forms: forms.map((form, i) => {\n            if (i === activeIndex) {\n              return {\n                errorCount: form.errorCount,\n                formID: form.formID,\n                formState: currentFormsData,\n                uploadEdits: form.uploadEdits,\n              }\n            }\n            return form\n          }),\n        },\n      })\n    },\n    [forms, activeIndex],\n  )\n\n  const addFiles = React.useCallback(\n    async (files: FileList) => {\n      if (forms.length) {\n        // save the state of the current form before adding new files\n        dispatch({\n          type: 'UPDATE_FORM',\n          errorCount: forms[activeIndex].errorCount,\n          formState: getFormDataRef.current(),\n          index: activeIndex,\n        })\n      }\n\n      toggleLoadingOverlay({ isLoading: true, key: 'addingDocs' })\n      if (!hasInitializedState) {\n        await initializeSharedFormState()\n      }\n      dispatch({\n        type: 'ADD_FORMS',\n        forms: Array.from(files).map((file) => ({\n          file,\n          initialState: initialStateRef.current,\n        })),\n      })\n      toggleLoadingOverlay({ isLoading: false, key: 'addingDocs' })\n    },\n    [initializeSharedFormState, hasInitializedState, toggleLoadingOverlay, activeIndex, forms],\n  )\n\n  const addFilesEffectEvent = useEffectEvent(addFiles)\n\n  const addInitialForms = useEffectEvent(async (initialForms: InitialForms) => {\n    toggleLoadingOverlay({ isLoading: true, key: 'addingDocs' })\n\n    if (!hasInitializedState) {\n      await initializeSharedFormState()\n    }\n\n    dispatch({\n      type: 'ADD_FORMS',\n      forms: initialForms.map((form) => ({\n        ...form,\n        initialState: form?.initialState || initialStateRef.current,\n      })),\n    })\n\n    toggleLoadingOverlay({ isLoading: false, key: 'addingDocs' })\n  })\n\n  const removeFile: FormsManagerContext['removeFile'] = React.useCallback((index) => {\n    dispatch({ type: 'REMOVE_FORM', index })\n  }, [])\n\n  const setFormTotalErrorCount: FormsManagerContext['setFormTotalErrorCount'] = React.useCallback(\n    ({ errorCount, index }) => {\n      dispatch({\n        type: 'UPDATE_ERROR_COUNT',\n        count: errorCount,\n        index,\n      })\n    },\n    [],\n  )\n\n  const saveAllDocs: FormsManagerContext['saveAllDocs'] = React.useCallback(\n    async ({ overrides } = {}) => {\n      const currentFormsData = getFormDataRef.current()\n      const currentForms = [...forms]\n      currentForms[activeIndex] = {\n        errorCount: currentForms[activeIndex].errorCount,\n        formID: currentForms[activeIndex].formID,\n        formState: currentFormsData,\n        uploadEdits: currentForms[activeIndex].uploadEdits,\n      }\n      const newDocs: Array<{\n        collectionSlug: CollectionSlug\n        doc: JsonObject\n        /**\n         * ID of the form that created this document\n         */\n        formID: string\n      }> = []\n\n      setIsUploading(true)\n\n      for (let i = 0; i < currentForms.length; i++) {\n        try {\n          const form = currentForms[i]\n\n          setLoadingText(t('general:uploadingBulk', { current: i + 1, total: currentForms.length }))\n\n          const actionURLWithParams = `${actionURL}${qs.stringify(\n            {\n              locale: code,\n              uploadEdits: form?.uploadEdits || undefined,\n            },\n            {\n              addQueryPrefix: true,\n            },\n          )}`\n\n          const req = await fetch(actionURLWithParams, {\n            body: await createFormData(\n              form.formState,\n              overrides,\n              collectionSlug,\n              getUploadHandler({ collectionSlug }),\n            ),\n            credentials: 'include',\n            method: 'POST',\n          })\n\n          const json = await req.json()\n\n          if (req.status === 201 && json?.doc) {\n            newDocs.push({\n              collectionSlug,\n              doc: json.doc,\n              formID: form.formID,\n            })\n          }\n\n          // should expose some sort of helper for this\n          const [fieldErrors, nonFieldErrors] = (json?.errors || []).reduce(\n            ([fieldErrs, nonFieldErrs], err) => {\n              const newFieldErrs: any[] = []\n              const newNonFieldErrs: any[] = []\n\n              if (err?.message) {\n                newNonFieldErrs.push(err)\n              }\n\n              if (Array.isArray(err?.data?.errors)) {\n                err.data?.errors.forEach((dataError) => {\n                  if (dataError?.path) {\n                    newFieldErrs.push(dataError)\n                  } else {\n                    newNonFieldErrs.push(dataError)\n                  }\n                })\n              }\n\n              return [\n                [...fieldErrs, ...newFieldErrs],\n                [...nonFieldErrs, ...newNonFieldErrs],\n              ]\n            },\n            [[], []],\n          )\n\n          currentForms[i] = {\n            errorCount: fieldErrors.length,\n            formID: currentForms[i].formID,\n            formState: fieldReducer(currentForms[i].formState, {\n              type: 'ADD_SERVER_ERRORS',\n              errors: fieldErrors,\n            }),\n          }\n\n          if (req.status === 413 || req.status === 400) {\n            // file too large\n            currentForms[i] = {\n              ...currentForms[i],\n              errorCount: currentForms[i].errorCount + 1,\n            }\n\n            toast.error(nonFieldErrors[0]?.message)\n          }\n        } catch (_) {\n          // swallow\n        }\n      }\n\n      setHasSubmitted(true)\n      setLoadingText('')\n      setIsUploading(false)\n\n      const remainingForms = []\n\n      currentForms.forEach(({ errorCount }, i) => {\n        if (errorCount) {\n          remainingForms.push(currentForms[i])\n        }\n      })\n\n      const successCount = Math.max(0, currentForms.length - remainingForms.length)\n      const errorCount = currentForms.length - successCount\n\n      if (successCount) {\n        toast.success(`Successfully saved ${successCount} files`)\n        setSuccessfullyUploaded(true)\n\n        if (typeof onSuccess === 'function') {\n          onSuccess(newDocs, errorCount)\n        }\n      }\n\n      if (errorCount) {\n        toast.error(`Failed to save ${errorCount} files`)\n      } else {\n        closeModal(drawerSlug)\n      }\n\n      dispatch({\n        type: 'REPLACE',\n        state: {\n          activeIndex: 0,\n          forms: remainingForms,\n          totalErrorCount: remainingForms.reduce((acc, { errorCount }) => acc + errorCount, 0),\n        },\n      })\n\n      if (remainingForms.length === 0) {\n        setInitialFiles(undefined)\n        setInitialForms(undefined)\n      }\n    },\n    [\n      forms,\n      activeIndex,\n      t,\n      actionURL,\n      code,\n      collectionSlug,\n      getUploadHandler,\n      onSuccess,\n      closeModal,\n      setSuccessfullyUploaded,\n      drawerSlug,\n      setInitialFiles,\n      setInitialForms,\n    ],\n  )\n\n  const bulkUpdateForm = React.useCallback(\n    async (updatedFields: Record<string, unknown>, afterStateUpdate?: () => void) => {\n      for (let i = 0; i < forms.length; i++) {\n        Object.entries(updatedFields).forEach(([path, value]) => {\n          if (forms[i].formState[path]) {\n            forms[i].formState[path].value = value\n\n            dispatch({\n              type: 'UPDATE_FORM',\n              errorCount: forms[i].errorCount,\n              formState: forms[i].formState,\n              index: i,\n            })\n          }\n        })\n\n        if (typeof afterStateUpdate === 'function') {\n          afterStateUpdate()\n        }\n\n        if (hasSubmitted) {\n          const { state } = await getFormState({\n            collectionSlug,\n            docPermissions,\n            docPreferences: null,\n            formState: forms[i].formState,\n            operation: 'create',\n            schemaPath: collectionSlug,\n          })\n\n          const newFormErrorCount = Object.values(state).reduce(\n            (acc, value) => (value?.valid === false ? acc + 1 : acc),\n            0,\n          )\n\n          dispatch({\n            type: 'UPDATE_FORM',\n            errorCount: newFormErrorCount,\n            formState: state,\n            index: i,\n          })\n        }\n      }\n    },\n    [collectionSlug, docPermissions, forms, getFormState, hasSubmitted],\n  )\n\n  const updateUploadEdits = React.useCallback<FormsManagerContext['updateUploadEdits']>(\n    (uploadEdits) => {\n      dispatch({\n        type: 'UPDATE_FORM',\n        errorCount: forms[activeIndex].errorCount,\n        formState: forms[activeIndex].formState,\n        index: activeIndex,\n        uploadEdits,\n      })\n    },\n    [activeIndex, forms],\n  )\n\n  const resetUploadEdits = React.useCallback<FormsManagerContext['resetUploadEdits']>(() => {\n    dispatch({\n      type: 'REPLACE',\n      state: {\n        forms: forms.map((form) => ({\n          ...form,\n          uploadEdits: {},\n        })),\n      },\n    })\n  }, [forms])\n\n  React.useEffect(() => {\n    if (!collectionSlug) {\n      return\n    }\n    if (!hasInitializedState) {\n      void initializeSharedFormState()\n    }\n\n    if (!hasInitializedDocPermissions) {\n      void initializeSharedDocPermissions()\n    }\n\n    if (initialFiles || initialForms) {\n      if (!hasInitializedState || !hasInitializedDocPermissions) {\n        setIsInitializing(true)\n      } else {\n        setIsInitializing(false)\n      }\n    }\n\n    if (\n      hasInitializedState &&\n      (initialForms?.length || initialFiles?.length) &&\n      !hasInitializedWithFiles.current\n    ) {\n      if (initialForms?.length) {\n        void addInitialForms(initialForms)\n      }\n      if (initialFiles?.length) {\n        void addFilesEffectEvent(initialFiles)\n      }\n      hasInitializedWithFiles.current = true\n    }\n    return\n  }, [\n    initialFiles,\n    initializeSharedFormState,\n    initializeSharedDocPermissions,\n    collectionSlug,\n    hasInitializedState,\n    hasInitializedDocPermissions,\n    initialForms,\n  ])\n\n  return (\n    <Context\n      value={{\n        activeIndex: state.activeIndex,\n        addFiles,\n        bulkUpdateForm,\n        collectionSlug,\n        docPermissions,\n        documentSlots,\n        forms,\n        getFormDataRef,\n        hasPublishPermission,\n        hasSavePermission,\n        hasSubmitted,\n        isInitializing,\n        removeFile,\n        resetUploadEdits,\n        saveAllDocs,\n        setActiveIndex,\n        setFormTotalErrorCount,\n        totalErrorCount,\n        updateUploadEdits,\n      }}\n    >\n      {isUploading && (\n        <LoadingOverlay\n          animationDuration=\"250ms\"\n          loadingText={loadingText}\n          overlayType=\"fullscreen\"\n          show\n        />\n      )}\n      {children}\n    </Context>\n  )\n}\n\nexport function useFormsManager() {\n  return React.use(Context)\n}\n"],"mappings":"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","ignoreList":[]}